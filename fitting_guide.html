<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Uncertainty Guide" href="uncertainty_guide.html" /><link rel="prev" title="Modeling Guide" href="modeling_guide.html" />

    <link rel="shortcut icon" href="_static/favicon.ico"/><!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Fitting Guide - DeerLab</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">DeerLab</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/logo_docs.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/logo_docs_light.svg" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="user_guide.html">User Guide</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of User Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="basics.html">Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="dipolar_guide_modeling.html">Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="dipolar_guide_fitting.html">Fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html">Theory</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="advanced_guide.html">Advanced</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Advanced</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="modeling_guide.html">Modeling Guide</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Fitting Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="uncertainty_guide.html">Uncertainty Guide</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="examples.html">Examples</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic_simulations/ex_simulate_basic_4pdeer.html">Simulating a 4-pulse DEER signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic_simulations/ex_simulate_5pdeer.html">Simulating a 5-pulse DEER signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic_simulations/ex_simulate_4pdeer.html">Simulating a three-pathway 4-pulse DEER signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic/ex_fitting_4pdeer.html">Basic analysis of a 4-pulse DEER signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic/ex_fitting_ridme.html">Basic analysis of a RIDME signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic/ex_fitting_4pdeer_compactness.html">Analysis of a 4-pulse DEER signal with a compactness penalty</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic/ex_bootstrapping.html">Bootstrapped confidence intervals in routine analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic/ex_fitting_4pdeer_gauss.html">Basic analysis of a 4-pulse DEER signal with a bimodal Gaussian model</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic/ex_fitting_5pdeer.html">Basic fitting of a 5-pulse DEER signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic/ex_restraints_4pdeer.html">Distance restraints from 4-pulse DEER data, non-parametric distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_multipathway_validation.html">Validating multi-pathway models based on the data</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_fitting_4pdeer_pathways.html">Analysis of a 4-pulse DEER signal with multiple dipolar pathways</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_fitting_dqc_pathways.html">Analysis of a 6-pulse DQC signal with multiple dipolar pathways</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_global_fitting_4pdeer.html">Global fitting of multiple 4-pulse DEER signals, non-parametric distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_fitting_5pdeer_pathways.html">Analysis of a 5-pulse DEER signal with multiple dipolar pathways</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_fitting_sparse_4pdeer.html">Basic analysis of a sparsely sampled 4-pulse DEER signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_compactness_with_without.html">Comparing the analysis with and without compactness criterion</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_global_different_deer.html">Global fitting of multiple different DEER signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_selregparam.html">Analysing the selection of regularisation parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_selregparam.html#over-and-under-selection-of-the-regularisation-parameter">Over and Under selection of the regularisation parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_crossing_echoes_masking.html">Analyzing data with crossing echoes robustly</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_simulating_oop.html">Simulating polarization effects on low-temperature DEER</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_identifiability_analysis.html">Identifiability analysis of a 4-pulse DEER signal via the profile analysis method</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_comparing_uncertainties.html">Comparing confidence intervals for regularization results</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_simulating_orisel.html">Simulating orientation selection effects in dipolar signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_extracting_gauss_constraints.html">Fitting Gaussians to a non-parametric distance distribution fit</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_profileanalysis.html">Profile analysis in routine analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_multigauss_fitting_4pdeer.html">Multi-Gaussian analysis of a dipolar signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_global_twostates_parametric.html">Global fitting of a two-state model to a series of DEER traces</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_dipolarpathways_selection.html">Dipolar pathways model selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_forcefield_fit.html">Fit a polynomial force field to a dipolar signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_pseudotitration_parameter_free.html">Analyzing pseudo-titration (dose-response) curves with non-parametric distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_droplets_model.html">Global analysis of 5-pulse DEER on a liquid-droplet protein system</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="modelsref.html">Models</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ex_3pdeer.html">deerlab.ex_3pdeer</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ex_4pdeer.html">deerlab.ex_4pdeer</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ex_rev5pdeer.html">deerlab.ex_rev5pdeer</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ex_fwd5pdeer.html">deerlab.ex_fwd5pdeer</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ex_sifter.html">deerlab.ex_sifter</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ex_dqc.html">deerlab.ex_dqc</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ex_ridme.html">deerlab.ex_ridme</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_gauss.html">deerlab.dd_gauss</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_gauss2.html">deerlab.dd_gauss2</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_gauss3.html">deerlab.dd_gauss3</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_rice.html">deerlab.dd_rice</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_rice2.html">deerlab.dd_rice2</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_rice3.html">deerlab.dd_rice3</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_gengauss.html">deerlab.dd_gengauss</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_skewgauss.html">deerlab.dd_skewgauss</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_cos.html">deerlab.dd_cos</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_wormchain.html">deerlab.dd_wormchain</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_wormgauss.html">deerlab.dd_wormgauss</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_randcoil.html">deerlab.dd_randcoil</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_sphere.html">deerlab.dd_sphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_spheresurf.html">deerlab.dd_spheresurf</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_spherepoint.html">deerlab.dd_spherepoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_shell.html">deerlab.dd_shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_shellshell.html">deerlab.dd_shellshell</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_shellsphere.html">deerlab.dd_shellsphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_shellvoidshell.html">deerlab.dd_shellvoidshell</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_shellvoidsphere.html">deerlab.dd_shellvoidsphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_circle.html">deerlab.dd_circle</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_triangle.html">deerlab.dd_triangle</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_uniform.html">deerlab.dd_uniform</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_hom3d.html">deerlab.bg_hom3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_hom3dex.html">deerlab.bg_hom3dex</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_homfractal.html">deerlab.bg_homfractal</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_hom3d_phase.html">deerlab.bg_hom3d_phase</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_hom3dex_phase.html">deerlab.bg_hom3dex_phase</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_homfractal_phase.html">deerlab.bg_homfractal_phase</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_exp.html">deerlab.bg_exp</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_strexp.html">deerlab.bg_strexp</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_sumstrexp.html">deerlab.bg_sumstrexp</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_prodstrexp.html">deerlab.bg_prodstrexp</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_poly1.html">deerlab.bg_poly1</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_poly2.html">deerlab.bg_poly2</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_poly3.html">deerlab.bg_poly3</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="reference.html">Reference Index</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Reference Index</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.Model.html">deerlab.Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.Parameter.html">deerlab.Parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.Penalty.html">deerlab.Penalty</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.FitResult.html">deerlab.FitResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.UQResult.html">deerlab.UQResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ExperimentInfo.html">deerlab.ExperimentInfo</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.fit.html">deerlab.fit</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.merge.html">deerlab.merge</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.link.html">deerlab.link</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.lincombine.html">deerlab.lincombine</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.relate.html">deerlab.relate</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.regoperator.html">deerlab.regoperator</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.selregparam.html">deerlab.selregparam</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.noiselevel.html">deerlab.noiselevel</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.whitegaussnoise.html">deerlab.whitegaussnoise</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.diststats.html">deerlab.diststats</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.correctphase.html">deerlab.correctphase</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bootstrap_analysis.html">deerlab.bootstrap_analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.profile_analysis.html">deerlab.profile_analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.snlls.html">deerlab.snlls</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.fnnls.html">deerlab.fnnls</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.cvxnnls.html">deerlab.cvxnnls</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.goodness_of_fit.html">deerlab.goodness_of_fit</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dipolarmodel.html">deerlab.dipolarmodel</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dipolarpenalty.html">deerlab.dipolarpenalty</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.deerload.html">deerlab.deerload</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dipolarkernel.html">deerlab.dipolarkernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dipolarbackground.html">deerlab.dipolarbackground</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.fftspec.html">deerlab.fftspec</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.distancerange.html">deerlab.distancerange</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.store_pickle.html">deerlab.store_pickle</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.read_pickle.html">deerlab.read_pickle</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.sophegrid.html">deerlab.sophegrid</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.choleskycovmat.html">deerlab.choleskycovmat</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.hccm.html">deerlab.hccm</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.Jacobian.html">deerlab.Jacobian</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.nearest_psd.html">deerlab.nearest_psd</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.movmean.html">deerlab.movmean</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ovl.html">deerlab.ovl</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.der_snr.html">deerlab.der_snr</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.formatted_table.html">deerlab.formatted_table</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Funding</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/JeschkeLab/DeerLab">Github</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/JeschkeLab/DeerLab/discussions">Discussion Board</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="fitting-guide">
<span id="id1"></span><h1>Fitting Guide<a class="headerlink" href="#fitting-guide" title="Link to this heading">#</a></h1>
<p>This guide will focus on the last step of the DeerLab workflow, i.e., the fitting. Due to the separation of non-linear parameters <img class="math" src="_images/math/8e9f8e664891f997469cb4ad9e5439e81d0660dc.svg" alt="\theta_\mathrm{nonlin}"/> and linear parameters <img class="math" src="_images/math/68a93297867e31caa33516d8d3534ab818c7e905.svg" alt="\theta_\mathrm{lin}"/> in the model structure of DeerLab, the program can use penalized separable non-linear least-squares to fit the model to the data. The fitting procedure aims to find the following optimization problem with the objective function</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="_images/math/0a669195c4e733f32c693cf9fd4a7e8dcebd67e4.svg" alt="\min_{\theta_\mathrm{nonlin}} \left\{ \Vert y - A(\theta_\mathrm{nonlin})\theta_\mathrm{lin}(\theta_\mathrm{nonlin}) \Vert^2  + \sum_i \gamma_i\mathcal{P}_i(\theta_\mathrm{nonlin},\theta_\mathrm{lin}) \right\} \\"/></p>
</div></div>
<p>with the linear part of the objective given by</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="_images/math/f2a2f74864f4b81b5b0096880839c879d86ec4fd.svg" alt="\theta_\mathrm{lin}(\theta_\mathrm{nonlin}) = {\arg\!\min}_{\theta} \left\{ \Vert y - A(\theta_\mathrm{nonlin})\theta \Vert^2 +  \alpha^2\mathcal{R}(\theta) \right\} \\"/></p>
</div></div>
<p>and all subject to the boundary conditions defined in the model</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="_images/math/c399199c56f71b63c379203f10eba352c504b0ff.svg" alt="\theta_\mathrm{lb} \leq \theta_\mathrm{nonlin} \leq \theta_\mathrm{ub} \quad\quad \theta_\mathrm{lbl} \leq \theta_\mathrm{lin} \leq \theta_\mathrm{ubl}"/></p>
</div></div>
<p>The term <img class="math" src="_images/math/9fa5636af77a9ff7c61943c7cddf370d0c09b274.svg" alt="A(\theta_\mathrm{nonlin})"/> is the non-linear function of the model. A regularization penalty <img class="math" src="_images/math/a2ea4e28b134adf895ee4d079b65868e160eb647.svg" alt="\mathcal{R}(\theta_\mathrm{lin})"/> weighted by a regularization weight or parameter <img class="math" src="_images/math/f36a3f8dbda6bea20079ecea63562c7932d00b1b.svg" alt="\alpha"/>, and multiple additional arbitrary penalty terms <img class="math" src="_images/math/c46422b33964608af7cf63390b465616f54031e9.svg" alt="\mathcal{P}_i(\theta_\mathrm{nonlin},\theta_\mathrm{lin})"/> each weighted by its own penalty weight <img class="math" src="_images/math/1befffcd1b819f2e5057daadfdb4d960e52b5f49.svg" alt="\gamma_i"/>, can be added to this objective function if wanted</p>
<section id="the-fit-function">
<h2>The <code class="docutils literal notranslate"><span class="pre">fit</span></code> function<a class="headerlink" href="#the-fit-function" title="Link to this heading">#</a></h2>
<p>DeerLab provides a centralized fitting function called <code class="docutils literal notranslate"><span class="pre">fit</span></code>. Its syntax is generally straightforward, taking a dataset and a model to be fitted to it. The function will always return a <code class="docutils literal notranslate"><span class="pre">FitResult</span></code> object containing all of the fitted quantities, including uncertainty estimates, as well as other quantities of interest. Assume that we have some dataset <code class="docutils literal notranslate"><span class="pre">y</span></code> described by some model called <code class="docutils literal notranslate"><span class="pre">model</span></code>. The fit can be executed as follows</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit the model to the data</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>If the model has parameters without assigned start values, the <code class="docutils literal notranslate"><span class="pre">fit</span></code> function will return an error and request them to be specified. They can be passed via the <code class="docutils literal notranslate"><span class="pre">par0</span></code> keyword argument passing the start values as a list</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit the model to the data with other start values</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">par0</span><span class="o">=</span><span class="n">par0_list</span><span class="p">)</span>
</pre></div>
</div>
<p>However, the list must be ordered according to the model parameter ordering. Therefore, we recommend specifying the start values on the model (as shown <a class="reference internal" href="modeling_guide.html#modeling-modifying-parameters"><span class="std std-ref">here</span></a>).</p>
<section id="specifying-the-noise-level-s">
<h3>Specifying the noise level(s)<a class="headerlink" href="#specifying-the-noise-level-s" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">fit</span></code> function (and other functions in the pipeline) employ the noise level of the dataset(s), i.e. the standard deviation of the white Gaussian noise superimposed on the data, at various stages of the model optimization and uncertainty estimation. Therefore, the analysis profits strongly from accurate estimates of the noise level(s). These can be specified via the <code class="docutils literal notranslate"><span class="pre">noiselvl</span></code> keyword argument of the <code class="docutils literal notranslate"><span class="pre">fit</span></code> function</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">yclean</span> <span class="o">+</span> <span class="n">dl</span><span class="o">.</span><span class="n">whitegaussnoise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="c1"># Fit the model (with two constants) to the data</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">constant1</span><span class="p">,</span> <span class="n">constant2</span><span class="p">,</span> <span class="n">noiselvl</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
<p>IF not specified, the program will estimate it from the dataset(s) directly using the <a class="reference internal" href="_autosummary/deerlab.noiselevel.html#noiselevel"><span class="std std-ref">deerlab.noiselevel</span></a> function. While, these estimates can be relatively accurate, it is better to specify the noise level if a trusted estimate is known.</p>
</section>
<section id="fitting-models-with-constants">
<h3>Fitting models with constants<a class="headerlink" href="#fitting-models-with-constants" title="Link to this heading">#</a></h3>
<p>Models with constants (see <a class="reference internal" href="modeling_guide.html#modeling-constants"><span class="std std-ref">here</span></a> for details) can be fitted as shown above, with the added requirement that the constants must be specified as well when calling <code class="docutils literal notranslate"><span class="pre">fit</span></code>. Constants can be specified after the data as positional arguments</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit the model (with two constants) to the data</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">constant1</span><span class="p">,</span> <span class="n">constant2</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="fitting-multi-dataset-models">
<h3>Fitting multi-dataset models<a class="headerlink" href="#fitting-multi-dataset-models" title="Link to this heading">#</a></h3>
<p>Models merged using the <code class="docutils literal notranslate"><span class="pre">merge</span></code> function (see <a class="reference internal" href="modeling_guide.html#modeling-merging"><span class="std std-ref">here</span></a> for details) can describe multiple datasets with a single model object and a common parameter set. To fit such a merged model to multiple datasets, the <code class="docutils literal notranslate"><span class="pre">fit</span></code> function can be used as above by passing a list of datasets <code class="docutils literal notranslate"><span class="pre">[y1,y2,...,yN]</span></code> instead of a single dataset</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit the model to multiple datasets</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">y3</span><span class="p">])</span>
</pre></div>
</div>
<p>The number of datasets must match the number of responses returned by the model. Additionally, the ordering in the list of datasets must match the order of responses from the model, i.e. <code class="docutils literal notranslate"><span class="pre">response1</span></code> of <code class="docutils literal notranslate"><span class="pre">model</span></code> will be fitted to <code class="docutils literal notranslate"><span class="pre">y1</span></code>, and so on.</p>
</section>
</section>
<section id="adding-regularization">
<h2>Adding regularization<a class="headerlink" href="#adding-regularization" title="Link to this heading">#</a></h2>
<p>DeerLab includes the possibility to impose (Tikhonov) regularization based on the smoothness of the linear parameters in the model. By default, DeerLab will automatically check the condition number of the matrix returned by the non-linear part of the model and determine whether it is well-conditioned or not. If the matrix is ill-conditioned, the program will automatically enforce regularization upon the linear parameters.
Regularization can be manually be switched on/off via the <code class="docutils literal notranslate"><span class="pre">reg</span></code> param</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Enforce regularization</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">reg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Disable regularization</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">reg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>The regularization penalty weight (a.k.a regularization parameter) is optimally selected according to a given criterion (by default, the Akaike information criterion, AIC). There are different ways to control this process:</p>
<section id="changing-the-selection-functional">
<h3>Changing the selection functional<a class="headerlink" href="#changing-the-selection-functional" title="Link to this heading">#</a></h3>
<p>The regularization functional can be changed from the AIC to any built-in functionals via the <img class="math" src="_images/math/43e847293a04eb1bd90bec393f433291bae5d9db.svg" alt="regparam"/> keyword argument. Changing it to another functional will only change how the regularization parameter is selected, but it still will be optimized. For example, to switch the selection functional from the AIC to generalized cross-validation (GCV)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit the model to the data, using the GCV criterion</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">regparam</span><span class="o">=</span><span class="s1">&#39;gcv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>A list of the available selection functionals and their string names are given in the reference for <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p>
</section>
<section id="changing-the-optimization-range">
<h3>Changing the optimization range<a class="headerlink" href="#changing-the-optimization-range" title="Link to this heading">#</a></h3>
<p>When using selection functionals to optimize the regularization weights, a Brent-like algorithm searches the value that minimizes the given selection functional within a specific range. This range can be manually specified via the <code class="docutils literal notranslate"><span class="pre">regparamrange</span></code> keyword argument. It must be passed as a two-element list <code class="docutils literal notranslate"><span class="pre">[regparam_lb,</span> <span class="pre">regparam_ub]</span></code> with the search boundaries</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit the model to the data, with a constrained regparam search range</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">regparamrange</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-5</span><span class="p">,</span><span class="mf">1e-1</span><span class="p">])</span>
</pre></div>
</div>
<p>This can be useful for avoiding unwanted local minima of the selection functional causing potential under- or oversmoothing.</p>
</section>
<section id="manual-specification">
<h3>Manual specification<a class="headerlink" href="#manual-specification" title="Link to this heading">#</a></h3>
<p>The value of the regularization penalty weight can also be manually specified and fixed to a value for the whole optimization. This can be done via the aforementioned <code class="docutils literal notranslate"><span class="pre">regparam</span></code> keyword argument by specifying a value instead of a selection functional</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit the model to the data, using a fixed regularization weight</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">regparam</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="adding-penalties">
<h2>Adding penalties<a class="headerlink" href="#adding-penalties" title="Link to this heading">#</a></h2>
<p>DeerLab provides a flexible system for defining and adding penalties to the objective function of the <code class="docutils literal notranslate"><span class="pre">fit</span></code> function in the form of the <code class="docutils literal notranslate"><span class="pre">Penalty</span></code> objects, which can be passed to the <code class="docutils literal notranslate"><span class="pre">penalties</span></code> keyword argument of the <code class="docutils literal notranslate"><span class="pre">fit</span></code> function</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit the model to the data with an additional penalty</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">y</span> <span class="n">penalties</span><span class="o">=</span><span class="n">penalty</span><span class="p">)</span>
</pre></div>
</div>
<p>Penalties are only added to the non-linear part of the separable non-linear least-squares objective function used in <code class="docutils literal notranslate"><span class="pre">fit</span></code>. For the linear part, only Tikhonov regularization can be imposed (see the previous section).</p>
<p>DeerLab’s penalties consist of the following components:</p>
<dl class="simple">
<dt>Penalty function</dt><dd><p>The penalty function takes model parameters and returns a vector of values that are appended to the least-squares residual. The function should ideally be convex, monotonically increasing, and defined everywhere. It can be freely constructed and defined.</p>
</dd>
<dt>Penalty weight</dt><dd><p>As its name indicates, the penalty weight balances the influence of the penalty with respect to the other terms in the objective function. It is treated similarly to model parameters, meaning that it has boundaries defined that can be manipulated freely.</p>
</dd>
<dt>Selection functional</dt><dd><p>The selection criterion desired for the optimized choice of penalty weight. Must be chosen from a collection of selection functionals.</p>
</dd>
</dl>
<section id="constructing-a-penalty">
<h3>Constructing a penalty<a class="headerlink" href="#constructing-a-penalty" title="Link to this heading">#</a></h3>
<p>Penalties can be constructed in a similar way to <a class="reference internal" href="modeling_guide.html#modeling-construction"><span class="std std-ref">how models are constructed</span></a>. Since penalties depend on a model’s parameters, and by extension, are specific for a given model, it is recommended to construct penalties after the model has been entirely constructed.</p>
<p>The first step is to construct the penalty function. First, it must be a callable function taking a series of positional arguments. The names of the arguments must match the names of the model parameters that the penalty depends on. Second, the function must return a vector, taking the following into account:</p>
<ul class="simple">
<li><p>The vector cannot change length/shape for different parameter combinations.</p></li>
<li><p>The program will internally compute the squared values and append the vector to the residual vector.</p></li>
<li><p>The penalty weight must not be included in the penalty function definition. It is accounted for internally upon constructing the penalty.</p></li>
</ul>
<p>Third, a selection functional for the optimal selection of the penalty weight must be chosen from a list of built-in functionals:</p>
<ul class="simple">
<li><p>Informational complexity criterion (<code class="docutils literal notranslate"><span class="pre">icc</span></code>)</p></li>
<li><p>Akaike information criterion (<code class="docutils literal notranslate"><span class="pre">aic</span></code>)</p></li>
<li><p>Bayesian information criterion (<code class="docutils literal notranslate"><span class="pre">bic</span></code>)</p></li>
<li><p>Corrected Akaike information criterion (<code class="docutils literal notranslate"><span class="pre">aicc</span></code>)</p></li>
</ul>
<p>Last, the penalty can be constructed using the <code class="docutils literal notranslate"><span class="pre">Penalty()</span></code> constructor passing the penalty function and selection functional</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the penalty function</span>
<span class="k">def</span> <span class="nf">penalty_fcn</span><span class="p">(</span><span class="n">param1</span><span class="p">,</span><span class="n">param2</span><span class="p">,</span><span class="n">param3</span><span class="p">):</span>
    <span class="c1"># compute something...</span>
    <span class="k">return</span> <span class="n">penalty_vector</span>
<span class="n">penaltyobj</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">Penalty</span><span class="p">(</span><span class="n">penalty_fcn</span><span class="p">,</span><span class="s1">&#39;aic&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Upon constructing the penalty, the penalty weight is introduced in the background. This can be accessed via the <code class="docutils literal notranslate"><span class="pre">&lt;Penalty&gt;.weight</span></code> attribute. The <code class="docutils literal notranslate"><span class="pre">weight</span></code> attribute is a <code class="docutils literal notranslate"><span class="pre">Parameter</span></code> object similar in behavior to model parameters, with the difference that it has no <code class="docutils literal notranslate"><span class="pre">linear</span></code> or <code class="docutils literal notranslate"><span class="pre">par0</span></code> attributes. Otherwise, its boundaries and other descriptors can be freely modified.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set boundaries for the penalty weight</span>
<span class="n">penaltyobj</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">lb</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">)</span>
<span class="c1"># Set a new description for the penalty weight</span>
<span class="n">penaltyobj</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">desciption</span> <span class="o">=</span> <span class="s1">&#39;A penalty weight&#39;</span>
</pre></div>
</div>
</section>
<section id="example-gaussian-smoothness-penalty">
<h3>Example: Gaussian smoothness penalty<a class="headerlink" href="#example-gaussian-smoothness-penalty" title="Link to this heading">#</a></h3>
<p>In this example, let us construct a penalty that imposes the smoothness of a Gaussian function. As a model, we will take the <code class="docutils literal notranslate"><span class="pre">gauss</span></code> model defined in <a class="reference internal" href="modeling_guide.html#modeling-example1"><span class="std std-ref">another example</span></a>. The function has to penalize roughness for imposing smoothness, which can be quantified by a discrete differential operator of second order (which we can generate using DeerLab’s <code class="docutils literal notranslate"><span class="pre">regoperator</span></code>). As a selection criterion, we will use the AIC functional.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Differential operator of second order</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">regoperator</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Define the penalty function</span>
<span class="k">def</span> <span class="nf">smoothness_fcn</span><span class="p">(</span><span class="n">center</span><span class="p">,</span><span class="n">std</span><span class="p">):</span>
    <span class="n">gaussian</span> <span class="o">=</span> <span class="n">gauss</span><span class="p">(</span><span class="n">center</span><span class="p">,</span><span class="n">std</span><span class="p">)</span>
    <span class="n">penalty_vector</span> <span class="o">=</span> <span class="n">L</span><span class="nd">@gaussian</span>
    <span class="k">return</span> <span class="n">penalty_vector</span>
<span class="c1"># Construct the penalty</span>
<span class="n">smoothness</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">Penalty</span><span class="p">(</span><span class="n">smoothness_fcn</span><span class="p">,</span><span class="s1">&#39;aic&#39;</span><span class="p">)</span>

<span class="c1"># Fit the model to the data with a smoothness penalty</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">gauss</span><span class="p">,</span><span class="n">y</span> <span class="n">penalties</span><span class="o">=</span><span class="n">smoothness</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="manually-setting-the-penalty-weight">
<h3>Manually setting the penalty weight<a class="headerlink" href="#manually-setting-the-penalty-weight" title="Link to this heading">#</a></h3>
<p>By default, the program will use the specified selection functional to optimize the value of the penalty weights in an outer optimization approach. The search range of this optimization routine is given by the boundaries <code class="docutils literal notranslate"><span class="pre">[weight.lb,</span> <span class="pre">weight.ub]</span></code> of the penalty weight. However, the penalty weight can be fixed to a specific value using the <code class="docutils literal notranslate"><span class="pre">freeze</span></code> method of the <code class="docutils literal notranslate"><span class="pre">weight</span></code> attribute</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use a fixed penalty weight</span>
<span class="n">penaltyobj</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">freeze</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
<span class="c1"># Fit the model to the data</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">gauss</span><span class="p">,</span><span class="n">y</span> <span class="n">penalties</span><span class="o">=</span><span class="n">penaltyobj</span><span class="p">)</span>
</pre></div>
</div>
<p>This will fix the value throughout the whole fitting approach and skip the outer optimization entirely (if no other penalties are passed).</p>
</section>
</section>
<section id="examining-the-results">
<span id="fitting-fitresult"></span><h2>Examining the results<a class="headerlink" href="#examining-the-results" title="Link to this heading">#</a></h2>
<p>A summary of the fit can be accessed by printing the <code class="docutils literal notranslate"><span class="pre">FitResult</span></code> object as returned by the <code class="docutils literal notranslate"><span class="pre">fit</span></code> function</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;print(result)</span>
<span class="go">Goodness-of-fit:</span>
<span class="go">========= ============= ============ ==================== =======</span>
<span class="go"> Dataset   Noise level   Reduced 𝛘2   Residual autocorr.   RMSD</span>
<span class="go">========= ============= ============ ==================== =======</span>
<span class="go">   #1         0.049        1.058            0.127          0.050</span>
<span class="go">========= ============= ============ ==================== =======</span>

<span class="go">Model parameters:</span>
<span class="go">=========== ======= ========================= ======= ================</span>
<span class="go"> Parameter   Value   95%-Confidence interval   Units   Description</span>
<span class="go">=========== ======= ========================= ======= ================</span>
<span class="go"> center      5.002   (4.995,5.010)             None    None</span>
<span class="go"> std         0.204   (0.196,0.212)             None    None</span>
<span class="go"> scale       0.999   (0.999,0.999)             None    Scaling factor</span>
<span class="go">=========== ======= ========================= ======= ================</span>
</pre></div>
</div>
<section id="the-fitresult-object">
<h3>The <code class="docutils literal notranslate"><span class="pre">FitResult</span></code> object<a class="headerlink" href="#the-fitresult-object" title="Link to this heading">#</a></h3>
<p>Once the fitting routine is finished, the <code class="docutils literal notranslate"><span class="pre">fit</span></code> function will return a <code class="docutils literal notranslate"><span class="pre">FitResult</span></code> object containing multiple quantities of interest.</p>
<dl class="simple">
<dt>Estimated parameters (<code class="docutils literal notranslate"><span class="pre">FitResult.&lt;param&gt;</span></code>)</dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">FitResult</span></code> will contain an attribute <code class="docutils literal notranslate"><span class="pre">&lt;param&gt;</span></code> of the same name as each parameter in the model. This will be the estimated maximum likelihood estimator of the model parameter for the given data and penalties.</p>
</dd>
<dt>Estimated parameter uncertainty (<code class="docutils literal notranslate"><span class="pre">FitResult.&lt;param&gt;Uncert</span></code>)</dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">FitResult</span></code> will contain an attribute <code class="docutils literal notranslate"><span class="pre">&lt;param&gt;Uncert</span></code> of the same name as each parameter in the model. This will contain the full uncertainty estimate of the parameter in the form of an <code class="docutils literal notranslate"><span class="pre">UQResult</span></code> object (see here for details).</p>
</dd>
<dt>Estimated model response (<code class="docutils literal notranslate"><span class="pre">FitResult.model</span></code>)</dt><dd><p>It is the maximum likelihood estimate of the model’s response. It can be computed as well from the model and the fitted parameter values.</p>
</dd>
<dt>Statistical descriptors (<code class="docutils literal notranslate"><span class="pre">FitResult.stats</span></code>)</dt><dd><p>A dictionary of statistical quantities such as reduced chi-square, RMSD or AIC values quantifying the goodness-of-fit and model complexity. The reduced chi-square statistic <code class="docutils literal notranslate"><span class="pre">FitResult.stats['chi2red']</span></code> allows the assessment of whether the fit describes the data or not. A comparable value to 1 will indicate a good fit of the input data. The AIC <code class="docutils literal notranslate"><span class="pre">FitResult.stats['aic']</span></code> and other information-based quantities allow the comparison between fits based on alternate models and selecting the most appropriate model.</p>
</dd>
<dt>Penalty and regularization weights (<code class="docutils literal notranslate"><span class="pre">FitResult.regparam</span></code> and <code class="docutils literal notranslate"><span class="pre">FitResult.penweights</span></code>)</dt><dd><p>Contain the regularization and penalty values used to find the maximum likelihood estimator.</p>
</dd>
</dl>
<p>The fit of the model to the data can be quickly assessed by calling the <code class="docutils literal notranslate"><span class="pre">FitResult.plot()</span></code> method. Since the <code class="docutils literal notranslate"><span class="pre">FitResult</span></code> has not
information on the abscissa values of the data, these must be specified separately. Similarly, we can also specify a label for the abscissa.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the data and fit</span>
<span class="n">result</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/advanced_guide1.png"><img alt="_images/advanced_guide1.png" src="_images/advanced_guide1.png" style="width: 450px;" /></a>
</section>
<section id="assessing-the-goodness-of-fit">
<span id="fitting-goodnessoffit"></span><h3>Assessing the goodness-of-fit<a class="headerlink" href="#assessing-the-goodness-of-fit" title="Link to this heading">#</a></h3>
<p>The results summary shown above contains several key quantities to quickly assess whether the model estimate obtained by the <code class="docutils literal notranslate"><span class="pre">fit</span></code>
function is a proper descriptor of the data. For each dataset analyzed, several quantities are returned. The <code class="docutils literal notranslate"><span class="pre">Noise</span> <span class="pre">level</span></code> value shows
either the estimated noise level of that dataset or the one specified by the user. The <code class="docutils literal notranslate"><span class="pre">Reduced</span> <span class="pre">𝛘2</span></code> value indicates how good the model fit
describes the data. Values close to one indicate a good fit of the data. The <code class="docutils literal notranslate"><span class="pre">Residual</span> <span class="pre">autocorr.</span></code> value (computed as <img class="math" src="_images/math/4d6d8a8fe6969d7e297583a5068a16c088398107.svg" alt="\vert 2 - d_\mathrm{DW} \vert"/>,
where <img class="math" src="_images/math/c70cc9d6a79993a2b4c3377a432ed76837161d1d.svg" alt="d_\mathrm{DW}"/> is the Durbin–Watson statistic) indicates the degree of (first-order) autocorrelation in the fit residual. Values larger than 0.5
indicate a significant amount of autocorrelation, meaning that either the noise if not independent or that the model might not have fully captured all
features in the data. The <code class="docutils literal notranslate"><span class="pre">RMSD</span></code> value does not provide any insight by itself, however, it can be used to compare the goodness-of-fit between different models.</p>
<p>To facilitate the inspection of the goodness-of-fit, DeerLab will highlight with colors those values that indicate a potential failure of the analysis.
If either or both the <code class="docutils literal notranslate"><span class="pre">Reduced</span> <span class="pre">𝛘2</span></code> or <code class="docutils literal notranslate"><span class="pre">Residual</span> <span class="pre">autocorr.</span></code> values are highlighted in yellow, this indicates that there is the significant possibility
that the model does not properly describe the data. If these values are shown in red, it will indicate that the model does not properly describe the data.</p>
<p>If yellow or red goodness-of-fit quantities are obtained after an analysis, the following steps can be taken to amend that:</p>
<ul class="simple">
<li><p>Check for outliers or features in the data not accounted for by the model.</p></li>
<li><p>Expand the model to account for them or approximate their presence.</p></li>
<li><p>If the model cannot be expanded to account for them, make use of the <code class="docutils literal notranslate"><span class="pre">fit</span></code> function’s <code class="docutils literal notranslate"><span class="pre">masks</span></code> optional argument to specify data masks so that those features are not accounted for during the analysis.</p></li>
</ul>
<p>Complementary, the goodness-of-fit can be assessed visually by calling the <code class="docutils literal notranslate"><span class="pre">plot(gof=True)</span></code> method of the <code class="docutils literal notranslate"><span class="pre">FitResult</span></code> object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the data, fit, and other goodness-of-fit tests</span>
<span class="n">result</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">gof</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/advanced_guide2.png"><img alt="_images/advanced_guide2.png" src="_images/advanced_guide2.png" style="width: 900px;" /></a>
<p>By doing so, several plots will be added to the previous figure. The first plot shows the data and the model fit (along its 95% confidence intervals). The second panel shows the residual values of the model fit. These values should resemble white noise, i.e. have constant variance and mean zero. The mean value of the residual is shown as a solid line. The estimated noise level (standard deviation) of the residual is shown as dashed lines. The third panel shows an histogram of the residual values. The residuals should be normally distributed. To assess this, the standard normal distribution is shown as a shaded grey area. Ideally, both the histogram and shaded distributed should overlap nicely, indicating normally distributed residuals. The last panel shows an autocorrelogram of the residuals and the grey shaded area represents the confidence region that would be expected of a purely random vector. Ideally, all autocorrelations at lags larger than 1 should be withing the shaded grey area. Any autocorrelations outside the grey shaded area can be considered as a potential autocorrelation in the data.</p>
</section>
<section id="evaluating-and-propagating-from-the-results">
<h3>Evaluating and propagating from the results<a class="headerlink" href="#evaluating-and-propagating-from-the-results" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">FitResult</span></code> object provides commodity methods <code class="docutils literal notranslate"><span class="pre">evaluate</span></code> and <code class="docutils literal notranslate"><span class="pre">propagate</span></code> to quickly evaluate other models that might depend on the fitted parameters and propagate the uncertainty in the parameter estimates to those models. To evaluate a model <code class="docutils literal notranslate"><span class="pre">modelB</span></code> that shares parameters with <code class="docutils literal notranslate"><span class="pre">modelA</span></code> (which has been fitted), we can use the <code class="docutils literal notranslate"><span class="pre">evaluate</span></code> method</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit modelA to the data</span>
<span class="n">fitresult</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">modelA</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="c1"># Evaluate modelB at the fitted parameters</span>
<span class="n">responseB</span> <span class="o">=</span> <span class="n">fitresult</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">modelB</span><span class="p">)</span>
</pre></div>
</div>
<p>Similarly, to propagate the uncertainty from the fitted parameters to <code class="docutils literal notranslate"><span class="pre">modelB</span></code> we can use the <code class="docutils literal notranslate"><span class="pre">propagate</span></code> method. This method takes additionally the optional keyword arguments <code class="docutils literal notranslate"><span class="pre">lb</span></code> and <code class="docutils literal notranslate"><span class="pre">ub</span></code> to specify any boundaries on the response <code class="docutils literal notranslate"><span class="pre">responseB</span></code> of <code class="docutils literal notranslate"><span class="pre">modelB</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit modelA to the data</span>
<span class="n">fitresult</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">modelA</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="c1"># Propagate the uncertainty to responseB (responseB is non-negative)</span>
<span class="n">responseBUncert</span> <span class="o">=</span> <span class="n">fitresult</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span><span class="n">modelB</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">responseB</span><span class="p">))</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">modelB</span></code> has any constants defined in the model, these must be specified as positional arguments after the model for both <code class="docutils literal notranslate"><span class="pre">evaluate</span></code> and <code class="docutils literal notranslate"><span class="pre">propagate</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit modelA to the data</span>
<span class="n">fitresult</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">modelA</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="c1"># Evaluate model with two constants</span>
<span class="n">responseB</span> <span class="o">=</span> <span class="n">fitresult</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">modelB</span><span class="p">,</span> <span class="n">constant1</span><span class="p">,</span> <span class="n">constant2</span><span class="p">)</span>
<span class="c1"># Propagate the uncertainty to model with two constants</span>
<span class="n">responseBUncert</span> <span class="o">=</span> <span class="n">fitresult</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span><span class="n">modelB</span><span class="p">,</span> <span class="n">constant1</span><span class="p">,</span> <span class="n">constant2</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that for <code class="docutils literal notranslate"><span class="pre">evaluate</span></code> and <code class="docutils literal notranslate"><span class="pre">propagate</span></code> to work, all the parameters of <code class="docutils literal notranslate"><span class="pre">modelB</span></code> must be contained in the <code class="docutils literal notranslate"><span class="pre">FitResult</span></code> object.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="uncertainty_guide.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Uncertainty Guide</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="modeling_guide.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Modeling Guide</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2019-2023, Luis Fábregas-Ibáñez, Stefan Stoll, Hugo Karas and others
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Fitting Guide</a><ul>
<li><a class="reference internal" href="#the-fit-function">The <code class="docutils literal notranslate"><span class="pre">fit</span></code> function</a><ul>
<li><a class="reference internal" href="#specifying-the-noise-level-s">Specifying the noise level(s)</a></li>
<li><a class="reference internal" href="#fitting-models-with-constants">Fitting models with constants</a></li>
<li><a class="reference internal" href="#fitting-multi-dataset-models">Fitting multi-dataset models</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-regularization">Adding regularization</a><ul>
<li><a class="reference internal" href="#changing-the-selection-functional">Changing the selection functional</a></li>
<li><a class="reference internal" href="#changing-the-optimization-range">Changing the optimization range</a></li>
<li><a class="reference internal" href="#manual-specification">Manual specification</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-penalties">Adding penalties</a><ul>
<li><a class="reference internal" href="#constructing-a-penalty">Constructing a penalty</a></li>
<li><a class="reference internal" href="#example-gaussian-smoothness-penalty">Example: Gaussian smoothness penalty</a></li>
<li><a class="reference internal" href="#manually-setting-the-penalty-weight">Manually setting the penalty weight</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examining-the-results">Examining the results</a><ul>
<li><a class="reference internal" href="#the-fitresult-object">The <code class="docutils literal notranslate"><span class="pre">FitResult</span></code> object</a></li>
<li><a class="reference internal" href="#assessing-the-goodness-of-fit">Assessing the goodness-of-fit</a></li>
<li><a class="reference internal" href="#evaluating-and-propagating-from-the-results">Evaluating and propagating from the results</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=7f41d439"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=4ea706d9"></script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    </body>
</html>