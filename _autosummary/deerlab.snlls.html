
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>deerlab.snlls &#8212; DeerLab</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/blank.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/theme_override.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="deerlab.fnnls" href="deerlab.fnnls.html" />
    <link rel="prev" title="deerlab.profile_analysis" href="deerlab.profile_analysis.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/logo_docs_paths.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <div class="container-fluid  px-0">
  
    <div class="navbar-collapse collapse navbar-collapse" id="navbar-collapsible">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
          <a class="nav-link nav-link" href="../installation.html">Installation</a>
        </li>

        <li class="dropdown">
          <a class="dropbtn" href="../user_guide.html" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">User Guide</a>
          <div class="dropdown-content" aria-labelledby="navbarDropdown">
              <a class="nav-dropdown-item dropdown-item" href="../basics.html">Basics</a>
              <a class="nav-dropdown-item dropdown-item" href="../getting_started.html">Getting Started</a>
              <a class="nav-dropdown-item dropdown-item" href="../dipolar_guide_modelling.html">Modelling</a>
              <a class="nav-dropdown-item dropdown-item" href="../dipolar_guide_fitting.html">Fitting</a>
              <a class="nav-dropdown-item dropdown-item" href="../theory.html">Theory</a>
          </div>
        </li>

        <li class="dropdown">
            <a class="dropbtn" href="../advanced_guide.html" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Advanced Guides</a>
            <div class="dropdown-content" aria-labelledby="navbarDropdown">
                <a class="nav-dropdown-item dropdown-item" href="../modelling_guide.html">Modelling Guide</a>
                <a class="nav-dropdown-item dropdown-item" href="../fitting_guide.html">Fitting Guide</a>
                <a class="nav-dropdown-item dropdown-item" href="../uncertainty_guide.html">Uncertainty Guide</a>
            </div>
          </li>

        <li class="nav-item">
          <a class="nav-link nav-link" href="../examples.html">Examples</a>
        </li>

        <li class="nav-item">
          <a class="nav-link nav-link" href="../modelsref.html">Models</a>
        </li>

        
        <li class="nav-item">
            <a class="nav-link nav-link" href="../reference.html">Reference</a>
          </li>

        <li class="dropdown">
          <a class="dropbtn nav-link dropdown-toggle" href="../more.html" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">More</a>
          <div class="dropdown-content" aria-labelledby="navbarDropdown">
              <a class="nav-dropdown-item dropdown-item" href="../changelog.html">Release Notes</a>
              <a class="nav-dropdown-item dropdown-item" href="../contributing.html">Contributing</a>
              <a class="nav-dropdown-item dropdown-item" href="../support.html">Support</a>
              <a class="nav-dropdown-item dropdown-item" href="../license.html">License</a>
              <a class="nav-dropdown-item dropdown-item" href="https://github.com/JeschkeLab/DeerLab">GitHub</a>
              <a class="nav-dropdown-item dropdown-item" href="https://pypi.org/project/DeerLab/#history">Other Versions and Download</a>
          </div>
        </li>
      </ul>

    </div>
  </div>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <div class="col-12 col-md-1 col-xl-2 bd-sidebar no-sidebar"></div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-11 col-xl-8 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="deerlab-snlls">
<span id="snlls"></span><h1>deerlab.snlls<a class="headerlink" href="#deerlab-snlls" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="deerlab.snlls">
<span class="sig-name descname"><span class="pre">snlls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Amodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ubl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nnlsSolver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cvx'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regparam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'aic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regparamrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multistart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphareopt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extrapenalty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_nfev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lin_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lin_maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noiselvl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lin_frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlin_frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deerlab/solvers.html#snlls"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deerlab.snlls" title="Permalink to this definition">¶</a></dt>
<dd><p>Separable non-linear least squares (SNLLS) solver</p>
<p>Fits a linear set of parameters <img class="math" src="../_images/math/68a93297867e31caa33516d8d3534ab818c7e905.svg" alt="\theta_\mathrm{lin}"/> and non-linear parameters <img class="math" src="../_images/math/8e9f8e664891f997469cb4ad9e5439e81d0660dc.svg" alt="\theta_\mathrm{nonlin}"/>
by solving the following general penalized separable non-linear least-squares problem:</p>
<div class="math">
<p><img src="../_images/math/ee69215099167bb131386674eb56a9ef81aff4cd.svg" alt="&amp; \quad\quad \min_{\theta_\mathrm{nonlin}} \left\{ \Vert y - A(\theta_\mathrm{nonlin})\theta_\mathrm{lin}(\theta_\mathrm{nonlin}) \Vert^2  + \mathcal{P}(\theta_\mathrm{nonlin},\theta_\mathrm{lin}) \right\} \\
&amp; \text{with} \\
&amp; \quad\quad \theta_\mathrm{lin}(\theta_\mathrm{nonlin}) = {\arg\!\min}_{\theta} \left\{ \Vert y - A(\theta_\mathrm{nonlin})\theta \Vert^2 +  \mathcal{R}(\theta) \right\} \\
&amp; \text{subject to} \\
&amp; \quad\quad \theta_\mathrm{lb} \leq \theta_\mathrm{nonlin} \leq \theta_\mathrm{ub} \quad\quad \theta_\mathrm{lbl} \leq \theta_\mathrm{lin} \leq \theta_\mathrm{ubl}"/></p>
</div><p>If the non-linear function <img class="math" src="../_images/math/9fa5636af77a9ff7c61943c7cddf370d0c09b274.svg" alt="A(\theta_\mathrm{nonlin})"/> yields an ill-conditioned problem, the solver will include a regularization penalty <img class="math" src="../_images/math/e3e949597ad541601eb0354ef14f68189dd2a9ab.svg" alt="\mathcal{R}(\theta)"/> (Tikhonov by default) 
with automated selection of the regularization parameter. Additional penalty terms <img class="math" src="../_images/math/cfb89d48c441234b8fbce7b3191139912c7de28c.svg" alt="\mathcal{P}(\theta_\mathrm{nonlin},\theta_\mathrm{lin})"/> can be included if specified.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>y</strong><span class="classifier">array_like or list of array_like</span></dt><dd><p>Input dataset(s) to be fitted.</p>
</dd>
<dt><strong>Amodel</strong><span class="classifier">callable</span></dt><dd><p>Function taking an array of non-linear parameters and
returning a matrix array or a list thereof.</p>
</dd>
<dt><strong>par0</strong><span class="classifier">array_like</span></dt><dd><p>Start values of the non-linear parameters.</p>
</dd>
<dt><strong>lb</strong><span class="classifier">array_like, optional</span></dt><dd><p>Lower bounds for the non-linear parameters, assumed unconstrained if not specified.</p>
</dd>
<dt><strong>ub</strong><span class="classifier">array_like, optional</span></dt><dd><p>Upper bounds for the non-linear parameters, assumed unconstrained if not specified.</p>
</dd>
<dt><strong>lbl</strong><span class="classifier">array_like, optional</span></dt><dd><p>Lower bounds for the linear parameters, assumed unconstrained if not specified.</p>
</dd>
<dt><strong>ubl</strong><span class="classifier">array_like, optional</span></dt><dd><p>Upper bounds for the linear parameters, assumed unconstrained if not specified.</p>
</dd>
<dt><strong>reg</strong><span class="classifier">boolean or string, optional</span></dt><dd><p>Determines the use of regularization on the solution of the linear problem.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'auto'</span></code> - Automatic decision based con the condition number of the non-linear model <code class="docutils literal notranslate"><span class="pre">Amodel</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code> - Forces regularization regardless of the condition number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code> - Disables regularization regardless of the condition number</p></li>
</ul>
<p>The default is <code class="docutils literal notranslate"><span class="pre">'auto'</span></code>.</p>
</dd>
<dt><strong>regparam</strong><span class="classifier">string or float scalar, optional</span></dt><dd><p>Method for the automatic selection of the optimal regularization parameter:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'lr'</span></code> - L-curve minimum-radius method (LR)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'lc'</span></code> - L-curve maximum-curvature method (LC)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'cv'</span></code> - Cross validation (CV)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'gcv'</span></code> - Generalized Cross Validation (GCV)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'rgcv'</span></code> - Robust Generalized Cross Validation (rGCV)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'srgcv'</span></code> - Strong Robust Generalized Cross Validation (srGCV)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'aic'</span></code> - Akaike information criterion (AIC)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'bic'</span></code> - Bayesian information criterion (BIC)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'aicc'</span></code> - Corrected Akaike information criterion (AICC)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'rm'</span></code> - Residual method (RM)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ee'</span></code> - Extrapolated Error (EE)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ncp'</span></code> - Normalized Cumulative Periodogram (NCP)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'gml'</span></code> - Generalized Maximum Likelihood (GML)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'mcl'</span></code> - Mallows’ C_L (MCL)</p></li>
</ul>
<p>The regularization parameter can be manually specified by passing a scalar value
instead of a string. The default <code class="docutils literal notranslate"><span class="pre">'aic'</span></code>.</p>
</dd>
<dt><strong>regparamrange</strong><span class="classifier">array_like, optional</span></dt><dd><p>Search range for the optimization of the regularization parameter. Must be specified as a list <code class="docutils literal notranslate"><span class="pre">[regparam_lb,regparam_ub]</span></code> 
with the lower/upper boundaries of the regularization parameter.</p>
</dd>
<dt><strong>regop</strong><span class="classifier">2D array_like, optional</span></dt><dd><p>Regularization operator matrix, the default is the second-order differential operator.</p>
</dd>
<dt><strong>extrapenalty: callable or list thereof, optional</strong></dt><dd><p>Custom penalty function(s) to impose upon the solution. A single penalty must be specified as a callable function. 
Multiple penalties can be specified as a list of callable functons. Each function must take two inputs, a vector of non-linear parameters
and a vector of linear parameters, and return a vector to be added to the residual vector (<code class="docutils literal notranslate"><span class="pre">pen</span> <span class="pre">=</span> <span class="pre">fcn(pnonlin,plin)</span></code>).  
The square of the penalty is computed internally.</p>
</dd>
<dt><strong>alphareopt</strong><span class="classifier">float scalar, optional</span></dt><dd><p>Relative parameter change threshold for reoptimizing the regularization parameter
when using a selection method, the default is <code class="docutils literal notranslate"><span class="pre">1e-3</span></code>.</p>
</dd>
<dt><strong>nnlsSolver</strong><span class="classifier">string, optional</span></dt><dd><p>Solver used to solve a non-negative least-squares problem (if applicable):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'cvx'</span></code> - Optimization of the NNLS problem using the cvxopt package.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'fnnls'</span></code> - Optimization using the fast NNLS algorithm.</p></li>
</ul>
<p>The default is <code class="docutils literal notranslate"><span class="pre">'cvx'</span></code>.</p>
</dd>
<dt><strong>noiselvl</strong><span class="classifier">array_like, optional</span></dt><dd><p>Noise standard deviation of the input signal(s), if not specified it is estimated automatically.</p>
</dd>
<dt><strong>mask</strong><span class="classifier">arrau_like or list thereof, optional</span></dt><dd><p>Array (or list of arrays) containing boolean (True/False) values defining a mask over one or multiple datasets.
All dataset point with enabled mask values (True) will be acoounted for during the fitting procedure. All disabled
values (False) will not be inlcuded. This does not affect model evaluation and uncertainty propagation.</p>
</dd>
<dt><strong>weights</strong><span class="classifier">array_like, optional</span></dt><dd><p>Array of weighting coefficients for the individual signals in global fitting.
If not specified all datasets are weighted inversely proportional to their noise levels.</p>
</dd>
<dt><strong>multistart</strong><span class="classifier">int scalar, optional</span></dt><dd><p>Number of starting points for global optimization, the default is <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
</dd>
<dt><strong>xtol</strong><span class="classifier">float scalar, optional</span></dt><dd><p>Tolerance for termination by the change of the independent variables. Default is 1e-8. The optimization process is stopped when <code class="docutils literal notranslate"><span class="pre">norm(dx)</span> <span class="pre">&lt;</span> <span class="pre">xtol</span> <span class="pre">*</span> <span class="pre">(xtol</span> <span class="pre">+</span> <span class="pre">norm(x))</span></code>.
If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, the termination by this condition is disabled.</p>
</dd>
<dt><strong>ftol</strong><span class="classifier">float scalar, optional</span></dt><dd><p>Tolerance for termination by the change of the cost function. Default is 1e-8. The optimization process is stopped when <code class="docutils literal notranslate"><span class="pre">dF</span> <span class="pre">&lt;</span> <span class="pre">ftol*F</span></code>, 
and there was an adequate agreement between a local quadratic model and the true model in the last step.
If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, the termination by this condition is disabled.</p>
</dd>
<dt><strong>max_nfev</strong><span class="classifier">float scalar, optional</span></dt><dd><p>Maximum number of function evaluations before the termination. the default is <code class="docutils literal notranslate"><span class="pre">1e8</span></code>.</p>
</dd>
<dt><strong>lin_maxiter</strong><span class="classifier">float scalar, optional</span></dt><dd><p>Linear solver maximal number of iterations, the default is <code class="docutils literal notranslate"><span class="pre">1e4</span></code>.</p>
</dd>
<dt><strong>lin_tol</strong><span class="classifier">float scalar, optional</span></dt><dd><p>Linear solver tolerance to decide when a value is defined as a zero, the default is <code class="docutils literal notranslate"><span class="pre">1e-15</span></code>.</p>
</dd>
<dt><strong>nonlin_frozen</strong><span class="classifier">array_like</span></dt><dd><p>Values for non-linear parameters to be frozen during the optimization. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code> a non-linear parameter 
will be optimized, if set to a numerical value it will be fixed to it and ignored during the optimization.</p>
</dd>
<dt><strong>lin_frozen</strong><span class="classifier">array_like</span></dt><dd><p>Values for linear parameters to be frozen during the optimization. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code> a linear parameter 
will be optimized, if set to a numerical value it will be fixed to it and ignored during the optimization.</p>
</dd>
<dt><strong>uq</strong><span class="classifier">boolean, optional</span></dt><dd><p>Enable/disable the uncertainty quantification analysis, by default it is enabled.</p>
</dd>
<dt><strong>subsets</strong><span class="classifier">array_like, optional</span></dt><dd><p>Vector of dataset subset indices, if the datasets are passed concatenated instead of a list.</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">scalar integer, optional</span></dt><dd><p>Level of verbosity during the analysis:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> : Work silently (default).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> : Display progress including the non-linear least-squares’ solver termination report.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> : Display progress including the non-linear least-squares’ solver iteration details.</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><a class="reference internal" href="deerlab.FitResult.html#fitresult"><span class="std std-ref">deerlab.FitResult</span></a> with the following fields defined:</dt><dd></dd>
<dt><strong>nonlin</strong><span class="classifier">ndarray</span></dt><dd><p>Fitted non-linear parameters.</p>
</dd>
<dt><strong>lin</strong><span class="classifier">ndarray</span></dt><dd><p>Fitted linear parameters.</p>
</dd>
<dt><strong>param</strong><span class="classifier">ndarray</span></dt><dd><p>Fitted full parameter set.</p>
</dd>
<dt><strong>model</strong><span class="classifier">ndarray</span></dt><dd><p>Fitted model.</p>
</dd>
<dt><strong>nonlinUncert</strong><span class="classifier"><a class="reference internal" href="deerlab.UQResult.html#uqresult"><span class="std std-ref">deerlab.UQResult</span></a></span></dt><dd><p>Uncertainty quantification of the non-linear parameter set.</p>
</dd>
<dt><strong>linUncert</strong><span class="classifier"><a class="reference internal" href="deerlab.UQResult.html#uqresult"><span class="std std-ref">deerlab.UQResult</span></a></span></dt><dd><p>Uncertainty quantification of the linear parameter set.</p>
</dd>
<dt><strong>paramUncert</strong><span class="classifier"><a class="reference internal" href="deerlab.UQResult.html#uqresult"><span class="std std-ref">deerlab.UQResult</span></a></span></dt><dd><p>Uncertainty quantification of the full parameter set.</p>
</dd>
<dt><strong>modelUncert</strong><span class="classifier"><a class="reference internal" href="deerlab.UQResult.html#uqresult"><span class="std std-ref">deerlab.UQResult</span></a></span></dt><dd><p>Uncertainty quantification of the fitted model.</p>
</dd>
<dt><strong>regparam</strong><span class="classifier">scalar</span></dt><dd><p>Regularization parameter value used for the regularization of the linear parameters.</p>
</dd>
<dt><strong>plot</strong><span class="classifier">callable</span></dt><dd><p>Function to display the results. It will display the fitted data.
The function returns the figure object (<code class="docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code>)
object as output, which can be modified. Using <code class="docutils literal notranslate"><span class="pre">fig</span> <span class="pre">=</span> <span class="pre">plot(show=False)</span></code> 
will not render the figure unless <code class="docutils literal notranslate"><span class="pre">display(fig)</span></code> is called.</p>
</dd>
<dt><strong>stats</strong><span class="classifier">dict</span></dt><dd><p>Goodness of fit statistical estimators</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">stats['chi2red']</span></code> - Reduced chi^2 test</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stats['r2']</span></code> - R^2 test</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stats['rmsd']</span></code> - Root-mean squared deviation (RMSD)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stats['aic']</span></code> - Akaike information criterion</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stats['aicc']</span></code> - Corrected Akaike information criterion</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stats['bic']</span></code> - Bayesian information criterion</p></li>
</ul>
</dd>
<dt><strong>success</strong><span class="classifier">bool</span></dt><dd><p>Whether or not the optimizer exited successfully.</p>
</dd>
<dt><strong>cost</strong><span class="classifier">float</span></dt><dd><p>Value of the cost function at the solution.</p>
</dd>
<dt><strong>residuals</strong><span class="classifier">ndarray</span></dt><dd><p>Vector of residuals at the solution.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="deerlab.profile_analysis.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">deerlab.profile_analysis</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="deerlab.fnnls.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">deerlab.fnnls</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2019-2022, Luis Fábregas-Ibáñez, Stefan Stoll, and others.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.2.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>