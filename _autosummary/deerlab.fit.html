
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>deerlab.fit &#8212; DeerLab</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/theme_override.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="deerlab.merge" href="deerlab.merge.html" />
    <link rel="prev" title="deerlab.UQResult" href="deerlab.UQResult.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/logo_docs_paths.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <div class="container-fluid  px-0">

    <div class="sk-navbar-collapse collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
          <a class="sk-nav-link nav-link" href="../installation.html">Installation</a>
        </li>

        <li class="dropdown">
          <a class="dropbtn" href="../user_guide.html" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">User Guide</a>
          <div class="dropdown-content" aria-labelledby="navbarDropdown">
              <a class="sk-nav-dropdown-item dropdown-item" href="../basics.html">Basics</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../getting_started.html">Getting Started</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../dipolar_guide_modelling.html">Modelling</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../dipolar_guide_fitting.html">Fitting</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../theory.html">Theory</a>
          </div>
        </li>

        <li class="dropdown">
            <a class="dropbtn" href="../advanced_guide.html" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Advanced Guides</a>
            <div class="dropdown-content" aria-labelledby="navbarDropdown">
                <a class="sk-nav-dropdown-item dropdown-item" href="../modelling_guide.html">Modelling Guide</a>
                <a class="sk-nav-dropdown-item dropdown-item" href="../fitting_guide.html">Fitting Guide</a>
                <a class="sk-nav-dropdown-item dropdown-item" href="../uncertainty_guide.html">Uncertainty Guide</a>
            </div>
          </li>

        <li class="nav-item">
          <a class="sk-nav-link nav-link" href="../examples.html">Examples</a>
        </li>

        <li class="nav-item">
          <a class="sk-nav-link nav-link" href="../modelsref.html">Models</a>
        </li>

        
        <li class="nav-item">
            <a class="sk-nav-link nav-link" href="../reference.html">Reference</a>
          </li>

        <li class="dropdown">
          <a class="dropbtn" href="../more.html" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">More</a>
          <div class="dropdown-content" aria-labelledby="navbarDropdown">
              <a class="sk-nav-dropdown-item dropdown-item" href="../changelog.html">Release Notes</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../contributing.html">Contributing</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../support.html">Support</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="../license.html">License</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="https://github.com/JeschkeLab/DeerLab">GitHub</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="https://pypi.org/project/DeerLab/#history">Other Versions and Download</a>
          </div>
        </li>
      </ul>

    </div>
  </div>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <div class="col-12 col-md-1 col-xl-2 bd-sidebar no-sidebar"></div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-11 col-xl-8 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="deerlab-fit">
<span id="fit"></span><h1>deerlab.fit<a class="headerlink" href="#deerlab-fit" title="Permalink to this headline">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="deerlab.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">constants</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">penalties</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noiselvl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regparam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'aic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regparamrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deerlab/model.html#fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deerlab.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Fit the model(s) to the dataset(s)</p>
<p>Fit the input model to the data <code class="docutils literal notranslate"><span class="pre">y</span></code> via one of the three following approaches:</p>
<ul class="simple">
<li><p>Non-linear least-squares</p></li>
<li><p>Regularized linear-least-squares</p></li>
<li><p>Separable non-linear least-squares</p></li>
</ul>
<p>The most appropiate solver is chosen automatically based on the model structure.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>model</strong><span class="classifier"><a class="reference internal" href="deerlab.Model.html#model"><span class="std std-ref">deerlab.Model</span></a></span></dt><dd><p>Model object.</p>
</dd>
<dt><strong>y</strong><span class="classifier">array_like</span></dt><dd><p>Data to be fitted.</p>
</dd>
<dt><strong>par0</strong><span class="classifier">array_like, optional</span></dt><dd><p>Value at which to initialize the parameter at the start of a fit routine. 
Must be specified if not defined in the model. Otherwise, it overrides the definition in the model. 
nnlsSolver : string, optional
Solver used to solve a non-negative least-squares problem (if applicable):</p>
</dd>
<dt><strong>noiselvl</strong><span class="classifier">array_like, optional</span></dt><dd><p>Noise standard deviation of the input signal(s), if not specified it is estimated automatically.</p>
</dd>
<dt><strong>mask</strong><span class="classifier">arrau_like or list thereof, optional</span></dt><dd><p>Array (or list of arrays) containing boolean (True/False) values defining a mask over one or multiple datasets.
All dataset point with enabled mask values (True) will be acoounted for during the fitting procedure. All disabled
values (False) will not be inlcuded. This does not affect model evaluation and uncertainty propagation.</p>
</dd>
<dt><strong>weights</strong><span class="classifier">array_like, optional</span></dt><dd><p>Array of weighting coefficients for the individual signals in global fitting.
If not specified all datasets are weighted inversely proportional to their noise levels.</p>
</dd>
<dt><strong>multistart</strong><span class="classifier">int scalar, optional</span></dt><dd><p>Number of starting points for global optimization, the default is <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
</dd>
<dt><strong>xtol</strong><span class="classifier">float scalar, optional</span></dt><dd><p>Tolerance for termination by the change of the independent variables. Default is 1e-8. The optimization process is stopped when <code class="docutils literal notranslate"><span class="pre">norm(dx)</span> <span class="pre">&lt;</span> <span class="pre">xtol</span> <span class="pre">*</span> <span class="pre">(xtol</span> <span class="pre">+</span> <span class="pre">norm(x))</span></code>.
If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, the termination by this condition is disabled.</p>
</dd>
<dt><strong>ftol</strong><span class="classifier">float scalar, optional</span></dt><dd><p>Tolerance for termination by the change of the cost function. Default is 1e-8. The optimization process is stopped when <code class="docutils literal notranslate"><span class="pre">dF</span> <span class="pre">&lt;</span> <span class="pre">ftol*F</span></code>, 
and there was an adequate agreement between a local quadratic model and the true model in the last step.
If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, the termination by this condition is disabled.</p>
</dd>
<dt><strong>max_nfev</strong><span class="classifier">float scalar, optional</span></dt><dd><p>Maximum number of function evaluations before the termination. the default is <code class="docutils literal notranslate"><span class="pre">1e8</span></code>.</p>
</dd>
<dt><strong>lin_maxiter</strong><span class="classifier">float scalar, optional</span></dt><dd><p>Linear solver maximal number of iterations, the default is <code class="docutils literal notranslate"><span class="pre">1e4</span></code>.</p>
</dd>
<dt><strong>lin_tol</strong><span class="classifier">float scalar, optional</span></dt><dd><p>Linear solver tolerance to decide when a value is defined as a zero, the default is <code class="docutils literal notranslate"><span class="pre">1e-15</span></code>.</p>
</dd>
<dt><strong>uq</strong><span class="classifier">boolean, optional</span></dt><dd><p>Enable/disable the uncertainty quantification analysis, by default it is enabled.</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">scalar integer, optional</span></dt><dd><p>Level of verbosity during the analysis:</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><a class="reference internal" href="deerlab.FitResult.html#fitresult"><span class="std std-ref">deerlab.FitResult</span></a> with the following fields defined:</dt><dd></dd>
<dt><strong>&lt;parameter_name&gt;</strong><span class="classifier"><a class="reference internal" href="deerlab.Parameter.html#parameter"><span class="std std-ref">deerlab.Parameter</span></a></span></dt><dd><p>Fitted value of the &lt;parameter_name&gt; model parameter.</p>
</dd>
<dt><strong>&lt;parameter_name&gt;Uncert</strong><span class="classifier"><a class="reference internal" href="deerlab.UQResult.html#uqresult"><span class="std std-ref">deerlab.UQResult</span></a></span></dt><dd><p>Uncertainty quantification of the &lt;parameter_name&gt; model parameter.</p>
</dd>
<dt><strong>param</strong><span class="classifier">ndarray</span></dt><dd><p>Fitted parameter vector ordered according to the model parameter indices.</p>
</dd>
<dt><strong>paramUncert</strong><span class="classifier"><a class="reference internal" href="deerlab.UQResult.html#uqresult"><span class="std std-ref">deerlab.UQResult</span></a></span></dt><dd><p>Uncertainty quantification of the parameter vector ordered according to the model parameter indices.</p>
</dd>
<dt><strong>model</strong><span class="classifier">ndarray</span></dt><dd><p>Fitted model response.</p>
</dd>
<dt><strong>modelUncert</strong><span class="classifier"><a class="reference internal" href="deerlab.UQResult.html#uqresult"><span class="std std-ref">deerlab.UQResult</span></a></span></dt><dd><p>Uncertainty quantification of the fitted model response.</p>
</dd>
<dt><strong>regparam</strong><span class="classifier">scalar</span></dt><dd><p>Regularization parameter value used for the regularization of the linear parameters.</p>
</dd>
<dt><strong>plot</strong><span class="classifier">callable</span></dt><dd><p>Function to display the results. It will display the fitted data.
The function returns the figure object (<code class="docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code>)
object as output, which can be modified. A vector for the x-axis and its label can
be specified by calling <code class="docutils literal notranslate"><span class="pre">FitResult.plot(axis=axis,xlabel='xlabel')</span></code>.</p>
</dd>
<dt><strong>stats</strong><span class="classifier">dict</span></dt><dd><p>Goodness of fit statistical estimators</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">stats['chi2red']</span></code> - Reduced chi^2 test</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stats['r2']</span></code> - R^2 test</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stats['rmsd']</span></code> - Root-mean squared deviation (RMSD)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stats['aic']</span></code> - Akaike information criterion</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stats['aicc']</span></code> - Corrected Akaike information criterion</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stats['bic']</span></code> - Bayesian information criterion</p></li>
</ul>
</dd>
<dt><strong>cost</strong><span class="classifier">float</span></dt><dd><p>Value of the cost function at the solution.</p>
</dd>
<dt><strong>evaluate(model, constants)</strong><span class="classifier">callable</span></dt><dd><p>Function to evaluate a model at the fitted parameter values. Takes a model object or callable function <code class="docutils literal notranslate"><span class="pre">model</span></code> to be evaluated.
All the parameters in the model or in the callable definition must match their corresponding parameter names in the <code class="docutils literal notranslate"><span class="pre">FitResult</span></code> object.   
Any model constants present required by the model must be specified as a second argument <code class="docutils literal notranslate"><span class="pre">constants</span></code>.  
It returns the model’s response at the fitted parameter values as an ndarray.</p>
</dd>
<dt><strong>propagate(model,constants,lb,ub)</strong><span class="classifier">callable</span></dt><dd><p>Function to propagate the uncertainty in the fit results to a model’s response. Takes a model object or callable function <code class="docutils literal notranslate"><span class="pre">model</span></code> to be evaluated.
All the parameters in the model or in the callable definition must match their corresponding parameter names in the <code class="docutils literal notranslate"><span class="pre">FitResult</span></code> object.  
Any model constants present required by the model must be specified as a second argument <code class="docutils literal notranslate"><span class="pre">constants</span></code>. The lower bounds <code class="docutils literal notranslate"><span class="pre">lb</span></code> and upper bounds <code class="docutils literal notranslate"><span class="pre">ub</span></code>
of the model’s response can be specified as a third and fourth argument respectively.  
It returns the model’s response uncertainty quantification as a <code class="docutils literal notranslate"><span class="pre">UQResult</span></code> object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="deerlab.UQResult.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">deerlab.UQResult</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="deerlab.merge.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">deerlab.merge</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2019-2022, Luis Fábregas-Ibáñez, Stefan Stoll, and others.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>