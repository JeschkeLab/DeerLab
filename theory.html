<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Advanced" href="advanced_guide.html" /><link rel="prev" title="Fitting" href="dipolar_guide_fitting.html" />

    <link rel="shortcut icon" href="_static/favicon.ico"/><!-- Generated with Sphinx 7.4.7 and Furo 2024.07.18 -->
        <title>Theory - DeerLab</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=613ab9ff" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">DeerLab</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/logo_docs.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/logo_docs_light.svg" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="user_guide.html">User Guide</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of User Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="basics.html">Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="dipolar_guide_modeling.html">Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="dipolar_guide_fitting.html">Fitting</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Theory</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="advanced_guide.html">Advanced</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Advanced</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="modeling_guide.html">Modeling Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="fitting_guide.html">Fitting Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="uncertainty_guide.html">Uncertainty Guide</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="examples.html">Examples</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic_simulations/ex_simulate_basic_4pdeer.html">Simulating a 4-pulse DEER signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic_simulations/ex_simulate_5pdeer.html">Simulating a 5-pulse DEER signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic_simulations/ex_simulate_4pdeer.html">Simulating a three-pathway 4-pulse DEER signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic/ex_fitting_4pdeer.html">Basic analysis of a 4-pulse DEER signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic/ex_fitting_ridme.html">Basic analysis of a RIDME signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic/ex_fitting_4pdeer_compactness.html">Analysis of a 4-pulse DEER signal with a compactness penalty</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic/ex_bootstrapping.html">Bootstrapped confidence intervals in routine analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic/ex_fitting_4pdeer_gauss.html">Basic analysis of a 4-pulse DEER signal with a bimodal Gaussian model</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic/ex_fitting_5pdeer.html">Basic fitting of a 5-pulse DEER signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic/ex_restraints_4pdeer.html">Distance restraints from 4-pulse DEER data, non-parametric distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_multipathway_validation.html">Validating multi-pathway models based on the data</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_fitting_4pdeer_pathways.html">Analysis of a 4-pulse DEER signal with multiple dipolar pathways</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_fitting_dqc_pathways.html">Analysis of a 6-pulse DQC signal with multiple dipolar pathways</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_global_fitting_4pdeer.html">Global fitting of multiple 4-pulse DEER signals, non-parametric distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_fitting_5pdeer_pathways.html">Analysis of a 5-pulse DEER signal with multiple dipolar pathways</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_fitting_sparse_4pdeer.html">Basic analysis of a sparsely sampled 4-pulse DEER signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_compactness_with_without.html">Comparing the analysis with and without compactness criterion</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_global_different_deer.html">Global fitting of multiple different DEER signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_crossing_echoes_masking.html">Analyzing data with crossing echoes robustly</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_selregparam.html">Analysing the selection of regularisation parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_simulating_oop.html">Simulating polarization effects on low-temperature DEER</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_identifiability_analysis.html">Identifiability analysis of a 4-pulse DEER signal via the profile analysis method</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_comparing_uncertainties.html">Comparing confidence intervals for regularization results</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_simulating_orisel.html">Simulating orientation selection effects in dipolar signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_extracting_gauss_constraints.html">Fitting Gaussians to a non-parametric distance distribution fit</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_profileanalysis.html">Profile analysis in routine analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_multigauss_fitting_4pdeer.html">Multi-Gaussian analysis of a dipolar signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_global_twostates_parametric.html">Global fitting of a two-state model to a series of DEER traces</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_dipolarpathways_selection.html">Dipolar pathways model selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_forcefield_fit.html">Fit a polynomial force field to a dipolar signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_pseudotitration_parameter_free.html">Analyzing pseudo-titration (dose-response) curves with non-parametric distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_droplets_model.html">Global analysis of 5-pulse DEER on a liquid-droplet protein system</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="modelsref.html">Models</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ex_3pdeer.html">deerlab.ex_3pdeer</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ex_4pdeer.html">deerlab.ex_4pdeer</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ex_rev5pdeer.html">deerlab.ex_rev5pdeer</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ex_fwd5pdeer.html">deerlab.ex_fwd5pdeer</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ex_sifter.html">deerlab.ex_sifter</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ex_dqc.html">deerlab.ex_dqc</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ex_ridme.html">deerlab.ex_ridme</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_gauss.html">deerlab.dd_gauss</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_gauss2.html">deerlab.dd_gauss2</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_gauss3.html">deerlab.dd_gauss3</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_rice.html">deerlab.dd_rice</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_rice2.html">deerlab.dd_rice2</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_rice3.html">deerlab.dd_rice3</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_gengauss.html">deerlab.dd_gengauss</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_skewgauss.html">deerlab.dd_skewgauss</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_cos.html">deerlab.dd_cos</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_wormchain.html">deerlab.dd_wormchain</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_wormgauss.html">deerlab.dd_wormgauss</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_randcoil.html">deerlab.dd_randcoil</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_sphere.html">deerlab.dd_sphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_spheresurf.html">deerlab.dd_spheresurf</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_spherepoint.html">deerlab.dd_spherepoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_shell.html">deerlab.dd_shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_shellshell.html">deerlab.dd_shellshell</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_shellsphere.html">deerlab.dd_shellsphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_shellvoidshell.html">deerlab.dd_shellvoidshell</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_shellvoidsphere.html">deerlab.dd_shellvoidsphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_circle.html">deerlab.dd_circle</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_triangle.html">deerlab.dd_triangle</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_uniform.html">deerlab.dd_uniform</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_hom3d.html">deerlab.bg_hom3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_hom3dex.html">deerlab.bg_hom3dex</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_homfractal.html">deerlab.bg_homfractal</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_hom3d_phase.html">deerlab.bg_hom3d_phase</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_hom3dex_phase.html">deerlab.bg_hom3dex_phase</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_homfractal_phase.html">deerlab.bg_homfractal_phase</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_exp.html">deerlab.bg_exp</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_strexp.html">deerlab.bg_strexp</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_sumstrexp.html">deerlab.bg_sumstrexp</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_prodstrexp.html">deerlab.bg_prodstrexp</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_poly1.html">deerlab.bg_poly1</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_poly2.html">deerlab.bg_poly2</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_poly3.html">deerlab.bg_poly3</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="reference.html">Reference Index</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Reference Index</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.Model.html">deerlab.Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.Parameter.html">deerlab.Parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.Penalty.html">deerlab.Penalty</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.FitResult.html">deerlab.FitResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.UQResult.html">deerlab.UQResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ExperimentInfo.html">deerlab.ExperimentInfo</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.fit.html">deerlab.fit</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.merge.html">deerlab.merge</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.link.html">deerlab.link</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.lincombine.html">deerlab.lincombine</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.relate.html">deerlab.relate</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.regoperator.html">deerlab.regoperator</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.selregparam.html">deerlab.selregparam</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.noiselevel.html">deerlab.noiselevel</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.whitegaussnoise.html">deerlab.whitegaussnoise</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.diststats.html">deerlab.diststats</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.correctphase.html">deerlab.correctphase</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bootstrap_analysis.html">deerlab.bootstrap_analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.profile_analysis.html">deerlab.profile_analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.snlls.html">deerlab.snlls</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.fnnls.html">deerlab.fnnls</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.cvxnnls.html">deerlab.cvxnnls</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.goodness_of_fit.html">deerlab.goodness_of_fit</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dipolarmodel.html">deerlab.dipolarmodel</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dipolarpenalty.html">deerlab.dipolarpenalty</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.deerload.html">deerlab.deerload</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dipolarkernel.html">deerlab.dipolarkernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dipolarbackground.html">deerlab.dipolarbackground</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.fftspec.html">deerlab.fftspec</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.distancerange.html">deerlab.distancerange</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.store_pickle.html">deerlab.store_pickle</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.read_pickle.html">deerlab.read_pickle</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.sophegrid.html">deerlab.sophegrid</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.choleskycovmat.html">deerlab.choleskycovmat</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.hccm.html">deerlab.hccm</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.Jacobian.html">deerlab.Jacobian</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.nearest_psd.html">deerlab.nearest_psd</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.movmean.html">deerlab.movmean</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ovl.html">deerlab.ovl</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.der_snr.html">deerlab.der_snr</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.formatted_table.html">deerlab.formatted_table</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Funding</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/JeschkeLab/DeerLab">Github</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/JeschkeLab/DeerLab/discussions">Discussion Board</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="theory">
<span id="id1"></span><h1>Theory<a class="headerlink" href="#theory" title="Link to this heading">¶</a></h1>
<p>This section summarizes key aspects of the theory implemented in DeerLab.</p>
<section id="assumptions">
<h2>Assumptions<a class="headerlink" href="#assumptions" title="Link to this heading">¶</a></h2>
<p>The theory underlying DeerLab is not fully general and makes a series of assumptions about the sample and the experiment. The important ones are:</p>
<p class="rubric">Spins-1/2</p>
<p>All spin labels are spin-1/2 or can be treated as such. High-spin systems are not handled by DeerLab.</p>
<p class="rubric">No delocalization</p>
<p>The unpaired electron spin density on the spin labels can be treated as localized in a single point. Delocalized spin systems are not handled by DeerLab.</p>
<p class="rubric">Isotropic g-values</p>
<p>All spins have essentially isotropic g values close to 2.00232. Spins with large g shifts and anisotropic g tensors are not handled by DeerLab.</p>
<p class="rubric">No exchange coupling</p>
<p>There is no exchange coupling between any spins. The only interaction is through-space dipolar coupling. Exchange coupling is not handled by DeerLab.</p>
<p class="rubric">Weak-coupling</p>
<p>The dipolar coupling between spins is in the weak-coupling regime, i.e. it is weaker than the difference between their resonance frequencies. Intermediate- and strong-coupling regimes are not handled by DeerLab.</p>
<p class="rubric">Relaxation times</p>
<p>All spins relax with the same phase memory time. Systems with rotamer-specific relaxation rates are not handled by DeerLab.</p>
<p class="rubric">No ESEEM modulation</p>
<p>The signal is free of modulations due to hyperfine couplings (ESEEM).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If your sample and experiment do not satisfy all these assumptions, DeerLab will give incorrect results.</p>
</div>
</section>
<section id="distance-distributions">
<h2>Distance distributions<a class="headerlink" href="#distance-distributions" title="Link to this heading">¶</a></h2>
<p>In DeerLab, distance distributions are assumed to be normalized</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="_images/math/1bdd543aa69ed33f75dfde774ee814b2a58b31ea.svg" alt="\int_0^\infty P(r)\mr{d}r = 1"/></p>
</div></div>
</section>
<section id="dipolar-signals-and-kernels">
<h2>Dipolar signals and kernels<a class="headerlink" href="#dipolar-signals-and-kernels" title="Link to this heading">¶</a></h2>
<p>A dipolar signal <img class="math" src="_images/math/e9886a754ebbf28585ca0662d3e5cb23e7b6ecc1.svg" alt="V(t)"/> is calculated from a distance distribution <img class="math" src="_images/math/865be106fc6ff8e698763f3b1bfb8777c311e175.svg" alt="P(r)"/> with the Fredholm integral of the first kind:</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="_images/math/9fd92f62158e9747850dc10774de7fc2cf4ffab4.svg" alt="V(t) = \int_0^\infty K(t,r)P(r)\mathrm{d}r"/></p>
</div></div>
<p>In this equation, <img class="math" src="_images/math/fe793936ba0e61f4fc14bc8096e9562a681a7596.svg" alt="K(t,r)"/> is the experiment-specific kernel representing how the signal is obtained from the distance distribution. Dipolar EPR experiments differ in the number and type of pulses, resulting in different number of dipolar pathways with different modulation amplitudes and refocusing times. In DeerLab, the signal from a general dipolar EPR experiment is modeled by the general kernel</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="_images/math/7391bc04adc075b317205896c2238924d86a8e57.svg" alt="K(t,r) = \left[\varLambda_0 + \sum_{p=1}^N \lambda_p K_0(n_p(t-T_p),r)\right]\cdot\prod_{p=1}^N B(n_p(t-T_p),\lambda_p)"/></p>
</div></div>
<p>Here, <img class="math" src="_images/math/cd3bdacef1f00f2a13c81b263d17ce67181f6176.svg" alt="\varLambda_0"/> is the total amplitude of all unmodulated pathways, <img class="math" src="_images/math/3c01db19d2bea9adb52e8e0b68b2983f852ba49a.svg" alt="N"/> is the number of modulated pathways, <img class="math" src="_images/math/7ccf960138aa970dde7e300ed80acb0ba8d6a92a.svg" alt="\lambda_p"/> is the amplitude of the <img class="math" src="_images/math/f34dbc6d5a7967f7cd44c892e8334bf194639367.svg" alt="p"/>th modulated pathway, <img class="math" src="_images/math/9f6e72e2ad90bae7dfdc2606d68eb394fd425009.svg" alt="T_p"/> is the refocusing time of the <img class="math" src="_images/math/f34dbc6d5a7967f7cd44c892e8334bf194639367.svg" alt="p"/>th modulated pathway, and <img class="math" src="_images/math/c99d0eac5bee31193f4a34aa4b1eb1356c7e5ab6.svg" alt="n_p"/> is the harmonic of the <img class="math" src="_images/math/f34dbc6d5a7967f7cd44c892e8334bf194639367.svg" alt="p"/>th pathway (most often, <img class="math" src="_images/math/ef8359e1b3ba0d4cc7834f68f2e00874e143107a.svg" alt="n=1"/>). <img class="math" src="_images/math/cd6c335e3ac72b5dc7aabd3deb98985161e2b8d7.svg" alt="B"/> is the background decay function.</p>
<p><img class="math" src="_images/math/afebfbb0ce8fe3050006799c90d7a133eb3bb76d.svg" alt="K_0"/> is the elementary kernel for a single dipolar pathway with 100% modulation amplitude and unlimited excitation bandwidth. It is given by</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="_images/math/6c03b7a758ae52415deec5e79be64734b460b416.svg" alt="K_0(t,r) =
\int_0^1
\cos\left((1-3\cos^2\theta) D r^{-3} t\right)
\mathrm{d}\cos\theta"/></p>
</div></div>
<p>with the dipolar constant</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="_images/math/e552b64cbdc0fa8311d84aa74f2c451db261c748.svg" alt="D =
\frac{\mu_0}{4\pi}
\frac{(\mu_\mathrm{B}g_\mathrm{e})^2}{\hbar}
\approx
2\pi\cdot 52\,\mathrm{MHz\,nm^3}"/></p>
</div></div>
<p>The closed-form expression for <img class="math" src="_images/math/afebfbb0ce8fe3050006799c90d7a133eb3bb76d.svg" alt="K_0"/> is</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="_images/math/7f9f870c46682dc46f96c889961fe632f1c018d5.svg" alt="K_0(t,r) = \frac{C(\xi)}{\xi}\cos(\omega_\perp t) + \frac{S(\xi)}{\xi} \sin(\omega_\perp t)"/></p>
</div></div>
<p>with <img class="math" src="_images/math/33b92ceaea45cdf1b51718e137cf35853eaa36fe.svg" alt="\xi = \sqrt{6\omega_\perp t/\pi}"/> and the Fresnel cosine and sine integral functions</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="_images/math/dd01ee244d9de18b26f95c9325060a45cd52208f.svg" alt="C(\xi) = \int_0^\xi \cos\left(\frac{\pi}{2}x^2\right)\mathrm{d}x
\qquad
S(\xi) = \int_0^\xi \sin\left(\frac{\pi}{2}x^2\right)\mathrm{d}x"/></p>
</div></div>
<p>For the common model used to analyze 4-pulse DEER data, the kernel is</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="_images/math/c5ce8c63423e2592e2fdc67704248177bf5d6a95.svg" alt="K(t,r) = \left[(1-\lambda) + \lambda K_0(t,r)\right]\cdot B(t,\lambda)"/></p>
</div></div>
<p>This is a special case of the general kernel, with <img class="math" src="_images/math/5bbedca28089e3c4c4f83f98e640e59bb72bad64.svg" alt="\varLambda_0 = 1-\lambda"/>, <img class="math" src="_images/math/b6f034b77e2d36ea862267e803b5783ffc9267e9.svg" alt="N=1"/>, <img class="math" src="_images/math/d0ffc479efaf553296877fa7a5869b719535ba52.svg" alt="\lambda_1=\lambda"/>, <img class="math" src="_images/math/dc66645ff067246cff0bf8082215ffc7b4b902a6.svg" alt="T_1 = 0"/>, and <img class="math" src="_images/math/c214d0f478c01b4d3a359b8af0e5c96c12efd35e.svg" alt="n_1=1"/>.</p>
</section>
<section id="discretization">
<h2>Discretization<a class="headerlink" href="#discretization" title="Link to this heading">¶</a></h2>
<p>In DeerLab, all signals <img class="math" src="_images/math/e269044f54fca5c90aea1119f12f325298f87254.svg" alt="V"/> and distributions <img class="math" src="_images/math/1465ca4878ed850cd1ad005602dd15610d20ef09.svg" alt="P"/> are represented as discretized vectors <img class="math" src="_images/math/3a6b910dd18d99a2378ecf363034109bef19d147.svg" alt="\vc{V}"/> and <img class="math" src="_images/math/00405087ce346a8bda8e91eeb0e4adc2ad89ad7e.svg" alt="\vc{P}"/> over discretized time domain <img class="math" src="_images/math/1c7125f3a41b7beaaf34031cca3e6857605c1e6b.svg" alt="\vc{t}"/> and distance domain <img class="math" src="_images/math/2a697e2fdb4c3b23ef1b3679cffb856965380d8c.svg" alt="\vc{r}"/>. Their elements are</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="_images/math/0afed0bb878255d5a2e4e65c189b499265018208.svg" alt="V_i = V(t_i)
\qquad
P_j = P(r_j)"/></p>
</div></div>
<p>Distance distribution vectors must have non-negative elements and are assumed to be normalized such that</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="_images/math/bd2f9d13b1e6b33c3370055b3d982c048e43aa5d.svg" alt="\sum_j P_j \Delta r  = 1"/></p>
</div></div>
<p><img class="math" src="_images/math/cc84710c9e803b6576d54fa9de22deeb10d0d718.svg" alt="\Delta r"/> is the constant increment along the distance domain. DeerLab does not support non-linear distance vectors with non-constant increments.</p>
<p>All kernels <img class="math" src="_images/math/aaeec87210b30e4651e6a2da06ffb44ef88f92c7.svg" alt="K"/> are discretized accordingly to give kernel matrices <img class="math" src="_images/math/f5eb4e2cf4ed4021ba1cc99246ee955e161a1acd.svg" alt="\mx{K}"/> with elements</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="_images/math/83d710dbb5fb74697302d6d4cc8bcebfdbe0c224.svg" alt="K_{ij} = K(t_i,r_j) \Delta r"/></p>
</div></div>
<p>With this, a signal is obtained from a distance distribution via</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="_images/math/e85480f095c6c3edd69114d76d0678eafd28f2bd.svg" alt="\vc{V} = \mx{K}\vc{P}"/></p>
</div></div>
</section>
<section id="least-squares-fitting">
<h2>Least-squares fitting<a class="headerlink" href="#least-squares-fitting" title="Link to this heading">¶</a></h2>
<p>DeerLab uses dedicated least-squares solvers to fit models to data. The objective function and the solver depend on whether the distance distribution is parametric or non-parametric, and on whether there are background and experiment parameters to fit alongside the distance distribution.</p>
<section id="parametric-distribution">
<h3>Parametric distribution<a class="headerlink" href="#parametric-distribution" title="Link to this heading">¶</a></h3>
<p>To fit a model with a parametric distance distribution to an experimental signal, DeerLab solves</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="_images/math/246bb3b6af41b51af54b3bc91e834808ab5d591a.svg" alt="\vc{\theta}_\mathrm{fit} =
\argmin_{\vc{\theta}}
\|\vc{V}_\mr{exp}-\mx{K}[\vc{\theta}]\vc{P}[\vc{\theta}]\|^2"/></p>
</div></div>
<p>where <img class="math" src="_images/math/4deb715aac28284fcf9b9914d7445bcda29849e2.svg" alt="\vc{V}_\mr{exp}"/> indicates the experimental data and <img class="math" src="_images/math/03267abad3188d4c36554870de0f16f22ca859f9.svg" alt="\vc{\theta}"/> is a vector of all parameters (distribution parameters, background parameters, experiment parameters). Various constrained least-squares solvers are implemented.</p>
</section>
<section id="non-parametric-distribution">
<h3>Non-parametric distribution<a class="headerlink" href="#non-parametric-distribution" title="Link to this heading">¶</a></h3>
<p>To fit a model with a non-parametric distribution and no additional fitting parameters to an experimental signal, DeerLab implements several regularization approaches. The most common one is Tikhonov regularization. For this, the minimization problem is</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="_images/math/3e6535b199c732a55047261e35bcb80f140645d2.svg" alt="\vc{P}_\mathrm{fit} =
\argmin_{\vc{P}\ge0}
\left(
\|\vc{V}_\mr{exp}-\mx{K}\vc{P}\|^2
+
\alpha^2
\|\mx{L}\vc{P}\|^2
\right)"/></p>
</div></div>
<p><img class="math" src="_images/math/f36a3f8dbda6bea20079ecea63562c7932d00b1b.svg" alt="\alpha"/> is the regularization parameter, and <img class="math" src="_images/math/2c17ba4408158db9dd83e9a59d7361eb32e61e3b.svg" alt="\mx{L}"/> is the regularization operator matrix. DeerLab implements the linear non-negative least-squares solver FNNLS, as well as a few others. The <img class="math" src="_images/math/f36a3f8dbda6bea20079ecea63562c7932d00b1b.svg" alt="\alpha"/> parameter can be optimized using a range of criteria, including L-curve, Akaike information criterion (AIC), and generalized cross validation (GCV).</p>
<p>To fit a  model with a non-parametric distance distribution and other parameters to an experimental signal, DeerLab solves</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="_images/math/f030a30038346543fde03a0bd206cb118574cd2e.svg" alt="(\vc{\theta}_\mathrm{fit},\vc{P}_\mr{fit})
=
\argmin_{\vc{\theta},\vc{P}\ge0}
\left(
\|\vc{V}_\mr{exp}-\mx{K}[\vc{\theta}]\vc{P}\|^2
+
\alpha^2
\|\mx{L}\vc{P}\|^2
\right)"/></p>
</div></div>
<p>This problem is solved directly, i.e. both <img class="math" src="_images/math/03267abad3188d4c36554870de0f16f22ca859f9.svg" alt="\vc{\theta}"/> ad <img class="math" src="_images/math/00405087ce346a8bda8e91eeb0e4adc2ad89ad7e.svg" alt="\vc{P}"/> are fitted simultaneously. To achieve this, DeerLab implements a nested optimization approach that includes regularization.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="advanced_guide.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Advanced</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="dipolar_guide_fitting.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Fitting</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2019-2023, Luis Fábregas-Ibáñez, Stefan Stoll, Hugo Karas and others
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Theory</a><ul>
<li><a class="reference internal" href="#assumptions">Assumptions</a></li>
<li><a class="reference internal" href="#distance-distributions">Distance distributions</a></li>
<li><a class="reference internal" href="#dipolar-signals-and-kernels">Dipolar signals and kernels</a></li>
<li><a class="reference internal" href="#discretization">Discretization</a></li>
<li><a class="reference internal" href="#least-squares-fitting">Least-squares fitting</a><ul>
<li><a class="reference internal" href="#parametric-distribution">Parametric distribution</a></li>
<li><a class="reference internal" href="#non-parametric-distribution">Non-parametric distribution</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=7f41d439"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=4ea706d9"></script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    </body>
</html>