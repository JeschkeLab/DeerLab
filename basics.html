<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Getting Started" href="getting_started.html" /><link rel="prev" title="User Guide" href="user_guide.html" />

    <link rel="shortcut icon" href="_static/favicon.ico"/><!-- Generated with Sphinx 7.2.2 and Furo 2023.08.19 -->
        <title>Basics - DeerLab</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">DeerLab</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/logo_docs.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/logo_docs_light.svg" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="user_guide.html">User Guide</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of User Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="dipolar_guide_modeling.html">Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="dipolar_guide_fitting.html">Fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html">Theory</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="advanced_guide.html">Advanced</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Advanced</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="modeling_guide.html">Modeling Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="fitting_guide.html">Fitting Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="uncertainty_guide.html">Uncertainty Guide</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="examples.html">Examples</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic_simulations/ex_simulate_basic_4pdeer.html">Simulating a 4-pulse DEER signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic_simulations/ex_simulate_5pdeer.html">Simulating a 5-pulse DEER signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic_simulations/ex_simulate_4pdeer.html">Simulating a three-pathway 4-pulse DEER signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic/ex_fitting_4pdeer.html">Basic analysis of a 4-pulse DEER signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic/ex_fitting_ridme.html">Basic analysis of a RIDME signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic/ex_fitting_4pdeer_compactness.html">Analysis of a 4-pulse DEER signal with a compactness penalty</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic/ex_bootstrapping.html">Bootstrapped confidence intervals in routine analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic/ex_fitting_4pdeer_gauss.html">Basic analysis of a 4-pulse DEER signal with a bimodal Gaussian model</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic/ex_fitting_5pdeer.html">Basic fitting of a 5-pulse DEER signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/basic/ex_restraints_4pdeer.html">Distance restraints from 4-pulse DEER data, non-parametric distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_multipathway_validation.html">Validating multi-pathway models based on the data</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_fitting_4pdeer_pathways.html">Analysis of a 4-pulse DEER signal with multiple dipolar pathways</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_fitting_dqc_pathways.html">Analysis of a 6-pulse DQC signal with multiple dipolar pathways</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_global_fitting_4pdeer.html">Global fitting of multiple 4-pulse DEER signals, non-parametric distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_fitting_5pdeer_pathways.html">Analysis of a 5-pulse DEER signal with multiple dipolar pathways</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_fitting_sparse_4pdeer.html">Basic analysis of a sparsely sampled 4-pulse DEER signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_compactness_with_without.html">Comparing the analysis with and without compactness criterion</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_global_different_deer.html">Global fitting of multiple different DEER signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_selregparam.html">Analysing the selection of regularisation parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_selregparam.html#over-and-under-selection-of-the-regularisation-parameter">Over and Under selection of the regularisation parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/intermediate/ex_crossing_echoes_masking.html">Analyzing data with crossing echoes robustly</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_simulating_oop.html">Simulating polarization effects on low-temperature DEER</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_identifiability_analysis.html">Identifiability analysis of a 4-pulse DEER signal via the profile analysis method</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_comparing_uncertainties.html">Comparing confidence intervals for regularization results</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_simulating_orisel.html">Simulating orientation selection effects in dipolar signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_long_threespin_analysis.html">Analyzing 4-pulse DEER data acquired on three-spin systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_extracting_gauss_constraints.html">Fitting Gaussians to a non-parametric distance distribution fit</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_profileanalysis.html">Profile analysis in routine analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_multigauss_fitting_4pdeer.html">Multi-Gaussian analysis of a dipolar signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_global_twostates_parametric.html">Global fitting of a two-state model to a series of DEER traces</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_dipolarpathways_selection.html">Dipolar pathways model selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_forcefield_fit.html">Fit a polynomial force field to a dipolar signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_pseudotitration_parameter_free.html">Analyzing pseudo-titration (dose-response) curves with non-parametric distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/advanced/ex_droplets_model.html">Global analysis of 5-pulse DEER on a liquid-droplet protein system</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="modelsref.html">Models</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ex_3pdeer.html">deerlab.ex_3pdeer</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ex_4pdeer.html">deerlab.ex_4pdeer</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ex_rev5pdeer.html">deerlab.ex_rev5pdeer</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ex_fwd5pdeer.html">deerlab.ex_fwd5pdeer</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ex_sifter.html">deerlab.ex_sifter</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ex_dqc.html">deerlab.ex_dqc</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ex_ridme.html">deerlab.ex_ridme</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_gauss.html">deerlab.dd_gauss</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_gauss2.html">deerlab.dd_gauss2</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_gauss3.html">deerlab.dd_gauss3</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_rice.html">deerlab.dd_rice</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_rice2.html">deerlab.dd_rice2</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_rice3.html">deerlab.dd_rice3</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_gengauss.html">deerlab.dd_gengauss</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_skewgauss.html">deerlab.dd_skewgauss</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_cos.html">deerlab.dd_cos</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_wormchain.html">deerlab.dd_wormchain</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_wormgauss.html">deerlab.dd_wormgauss</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_randcoil.html">deerlab.dd_randcoil</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_sphere.html">deerlab.dd_sphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_spheresurf.html">deerlab.dd_spheresurf</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_spherepoint.html">deerlab.dd_spherepoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_shell.html">deerlab.dd_shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_shellshell.html">deerlab.dd_shellshell</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_shellsphere.html">deerlab.dd_shellsphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_shellvoidshell.html">deerlab.dd_shellvoidshell</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_shellvoidsphere.html">deerlab.dd_shellvoidsphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_circle.html">deerlab.dd_circle</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_triangle.html">deerlab.dd_triangle</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dd_uniform.html">deerlab.dd_uniform</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_hom3d.html">deerlab.bg_hom3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_hom3dex.html">deerlab.bg_hom3dex</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_homfractal.html">deerlab.bg_homfractal</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_hom3d_phase.html">deerlab.bg_hom3d_phase</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_hom3dex_phase.html">deerlab.bg_hom3dex_phase</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_homfractal_phase.html">deerlab.bg_homfractal_phase</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_exp.html">deerlab.bg_exp</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_strexp.html">deerlab.bg_strexp</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_sumstrexp.html">deerlab.bg_sumstrexp</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_prodstrexp.html">deerlab.bg_prodstrexp</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_poly1.html">deerlab.bg_poly1</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_poly2.html">deerlab.bg_poly2</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bg_poly3.html">deerlab.bg_poly3</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="reference.html">Reference Index</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Reference Index</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.Model.html">deerlab.Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.Parameter.html">deerlab.Parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.Penalty.html">deerlab.Penalty</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.FitResult.html">deerlab.FitResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.UQResult.html">deerlab.UQResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ExperimentInfo.html">deerlab.ExperimentInfo</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.fit.html">deerlab.fit</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.merge.html">deerlab.merge</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.link.html">deerlab.link</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.lincombine.html">deerlab.lincombine</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.relate.html">deerlab.relate</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.regoperator.html">deerlab.regoperator</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.selregparam.html">deerlab.selregparam</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.noiselevel.html">deerlab.noiselevel</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.whitegaussnoise.html">deerlab.whitegaussnoise</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.diststats.html">deerlab.diststats</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.correctphase.html">deerlab.correctphase</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.bootstrap_analysis.html">deerlab.bootstrap_analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.profile_analysis.html">deerlab.profile_analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.snlls.html">deerlab.snlls</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.fnnls.html">deerlab.fnnls</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.cvxnnls.html">deerlab.cvxnnls</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.goodness_of_fit.html">deerlab.goodness_of_fit</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dipolarmodel.html">deerlab.dipolarmodel</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dipolarpenalty.html">deerlab.dipolarpenalty</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.deerload.html">deerlab.deerload</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dipolarkernel.html">deerlab.dipolarkernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.dipolarbackground.html">deerlab.dipolarbackground</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.fftspec.html">deerlab.fftspec</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.distancerange.html">deerlab.distancerange</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.store_pickle.html">deerlab.store_pickle</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.read_pickle.html">deerlab.read_pickle</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.sophegrid.html">deerlab.sophegrid</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.choleskycovmat.html">deerlab.choleskycovmat</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.hccm.html">deerlab.hccm</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.Jacobian.html">deerlab.Jacobian</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.nearest_psd.html">deerlab.nearest_psd</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.movmean.html">deerlab.movmean</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.ovl.html">deerlab.ovl</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.der_snr.html">deerlab.der_snr</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/deerlab.formatted_table.html">deerlab.formatted_table</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Funding</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/JeschkeLab/DeerLab">Github</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/JeschkeLab/DeerLab/discussions">Discussion Board</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="basics">
<h1>Basics<a class="headerlink" href="#basics" title="Link to this heading">#</a></h1>
<p>DeerLab applications to dipolar EPR spectroscopy relies on a few central quantities. They include distance distributions and model functions, background and their model functions, time-domain signals, and kernels. They are described in this section.</p>
<p>All functions in DeerLab use the same units: all distances are in units of <strong>nanometers</strong>, and all times in units of <strong>microseconds</strong>.</p>
<section id="distance-distributions">
<h2>Distance distributions<a class="headerlink" href="#distance-distributions" title="Link to this heading">#</a></h2>
<p>A distance distribution <img class="math" src="_images/math/865be106fc6ff8e698763f3b1bfb8777c311e175.svg" alt="P(r)"/> between two spins is represented by a pair of vectors: a distance vector <code class="docutils literal notranslate"><span class="pre">r</span></code> (in nanometers) and a vector of densities <code class="docutils literal notranslate"><span class="pre">P</span></code> (in inverse nanometers). The distance vector <code class="docutils literal notranslate"><span class="pre">r</span></code> can have linearly or non-linearly increasing values, but must have positive non-zero values. The elements <code class="docutils literal notranslate"><span class="pre">P[i]</span></code> are the distance distribution values at <code class="docutils literal notranslate"><span class="pre">r[i]</span></code> and are positive or zero. Outside of the range defined by <code class="docutils literal notranslate"><span class="pre">r</span></code>, the distribution <code class="docutils literal notranslate"><span class="pre">P</span></code> is assumed to be zero, i.e. the distribution is truncated to the range <code class="docutils literal notranslate"><span class="pre">r</span></code>. The distance distribution <code class="docutils literal notranslate"><span class="pre">P</span></code> is normalized such that the integral over the range of the provided <code class="docutils literal notranslate"><span class="pre">r</span></code> equals one:</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="_images/math/40d7709134fc915404f6e8db4c8228b788d0c999.svg" alt="\int_{r_\mathrm{min}}^{r_\mathrm{max}} P(r) \mathrm{d}r = 1"/></p>
</div></div>
<p>DeerLab distinguishes between <em>non-parametric</em> and <em>parametric</em> distance distributions.</p>
<dl>
<dt>Non-parametric distance distributions</dt><dd><p>These provide the more general definition of distance distributions. They have no particular shape and are represented by the vectors <code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">r</span></code>.
For example, you can generate <code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">r</span></code> by an external program for spin label rotamer modeling or from molecular dynamics simulations.</p>
</dd>
<dt>Parametric distance distributions</dt><dd><p>These have specific shapes that are determined by a few parameters. DeerLab provides many parametric distance distribution <a class="reference internal" href="modelsref.html#modelsref-dd"><span class="std std-ref">built-in models</span></a>. All these model’s names start with the prefix <code class="docutils literal notranslate"><span class="pre">dd_</span></code> (<code class="docutils literal notranslate"><span class="pre">dd</span></code> stands for “distance distribution”). They take a distance vector <code class="docutils literal notranslate"><span class="pre">r</span></code> and a parameter vector <code class="docutils literal notranslate"><span class="pre">param</span></code> as inputs and return the distance distribution as a vector <code class="docutils literal notranslate"><span class="pre">P</span></code>. Here is an example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>        <span class="c1"># distance vector, in nm</span>
<span class="n">rmean</span> <span class="o">=</span> <span class="mi">3</span>                         <span class="c1"># nm, mean of Gaussian</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.2</span>                       <span class="c1"># nm, standard deviation of Gaussian</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">dd_gauss</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">rmean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="c1"># Gaussian distribution</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
</pre></div>
</div>
<p>To programmatically get information on a particular distance distribution <a class="reference internal" href="modelsref.html#modelsref-dd"><span class="std std-ref">model</span></a> and its parameters, print the model, which will return information on the model itself, its call signature, and a parameter table containing all the model parameters, its boundaries, start values and other useful information</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;print(dl.dd_gauss)</span>
<span class="go">Description: Gaussian distribution model</span>
<span class="go">Signature: (r, mean, std)</span>
<span class="go">Constants: [r]</span>
<span class="go">Parameter Table:</span>
<span class="go">====== ======= ======= ======= ======== ======== ====== ====================</span>
<span class="go">Name   Lower   Start   Upper    Type    Frozen   Unit   Description</span>
<span class="go">====== ======= ======= ======= ======== ======== ====== ====================</span>
<span class="go">mean       1     3.5      20   nonlin     No      nm    Mean</span>
<span class="go">std     0.05     0.2     2.5   nonlin     No      nm    Standard deviation</span>
<span class="go">====== ======= ======= ======= ======== ======== ====== ====================</span>
</pre></div>
</div>
</dd>
</dl>
<p>In least-squares fitting, non-parametric distance distributions make fewer assumptions about the distribution than parametric distance distributions. They are more flexible and introduce less bias.</p>
</section>
<section id="dipolar-background">
<span id="bgmodels"></span><h2>Dipolar background<a class="headerlink" href="#dipolar-background" title="Link to this heading">#</a></h2>
<p>In DeerLab, all inter-molecular contributions to the dipolar modulation (i.e. the echo modulation function due to randomly distributed spins in the sample that are not part of the spin-labeled protein or object) are referred to as the dipolar background. DeerLab has a range of parametric models for the background. All these background <a class="reference internal" href="modelsref.html#modelsref-bg"><span class="std std-ref">model’s</span></a> names start with the prefix <code class="docutils literal notranslate"><span class="pre">bg_</span></code>. They take the time axis vector <code class="docutils literal notranslate"><span class="pre">t</span></code> (in microseconds) and a parameter vector <code class="docutils literal notranslate"><span class="pre">param</span></code> as inputs. The output is a background vector <code class="docutils literal notranslate"><span class="pre">B</span></code> defined over <code class="docutils literal notranslate"><span class="pre">t</span></code>. To get information on the model and its parameters, print the model</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;print(dl.bg_hom3d)</span>
<span class="go">Description: Background from homogeneous distribution of spins in a 3D medium</span>
<span class="go">Signature: (t, conc, lam)</span>
<span class="go">Constants: [t]</span>
<span class="go">Parameter Table:</span>
<span class="go">====== ======= ======= ======= ======== ======== ====== ====================</span>
<span class="go">Name   Lower   Start   Upper    Type    Frozen   Unit   Description</span>
<span class="go">====== ======= ======= ======= ======== ======== ====== ====================</span>
<span class="go">conc    0.01      50   5e+03   nonlin     No      μM    Spin concentration</span>
<span class="go">lam        0       1       1   nonlin     No            Pathway amplitude</span>
<span class="go">====== ======= ======= ======= ======== ======== ====== ====================</span>
</pre></div>
</div>
<p>DeerLab’s <a class="reference internal" href="modelsref.html#modelsref-bg"><span class="std std-ref">background models</span></a> fall into two categories, physical and phenomenological:</p>
<dl>
<dt>Physical background models</dt><dd><p>Describe particular distributions of spin labels in space and depend on physical parameters such as spin concentration, exclusion distances, and fractal dimensionality. The most common background model is <a class="reference internal" href="_autosummary/deerlab.bg_hom3d.html#bg-hom3d"><span class="std std-ref">deerlab.bg_hom3d</span></a>, which describes the signal due to a homogeneous three-dimensional distribution of spins of a given concentration. A background due to a homogeneous distribution of spins in fractal dimensions is available with <a class="reference internal" href="_autosummary/deerlab.bg_homfractal.html#bg-homfractal"><span class="std std-ref">deerlab.bg_homfractal</span></a>, and excluded-volume effects can be accounted for using <a class="reference internal" href="_autosummary/deerlab.bg_hom3dex.html#bg-hom3dex"><span class="std std-ref">deerlab.bg_hom3dex</span></a> to model the background.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>    <span class="c1"># time, in microseconds</span>
<span class="n">lam</span> <span class="o">=</span> <span class="mf">0.4</span>                      <span class="c1"># modulation depth</span>
<span class="n">conc</span> <span class="o">=</span> <span class="mi">70</span>                      <span class="c1"># spin concentration, in µM</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">bg_hom3d</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">conc</span><span class="p">,</span><span class="n">lam</span><span class="p">)</span>    <span class="c1"># homogeneous 3D background</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Phenomenological background models</dt><dd><p>Represent various mathematical functions that are intended to <em>mimic</em> the background decay, without reference to a particular spatial distribution of spins. The parameters of these models do no have a direct physical meaning. Some examples include <a class="reference internal" href="_autosummary/deerlab.bg_exp.html#bg-exp"><span class="std std-ref">deerlab.bg_exp</span></a>, which models the background decay as a simple exponential function, or <a class="reference internal" href="_autosummary/deerlab.bg_strexp.html#bg-strexp"><span class="std std-ref">deerlab.bg_strexp</span></a> which model the background decay as a stretched exponential function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>    <span class="c1"># time, in microseconds</span>
<span class="n">kappa</span> <span class="o">=</span> <span class="mf">0.35</span>                   <span class="c1"># decay rate, in inverse microseconds</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">bg_exp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">kappa</span><span class="p">)</span>         <span class="c1"># exponential background</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p>In general, it is preferable to use physical instead of phenomenological models.</p>
</section>
<section id="experiments">
<span id="exmodels"></span><h2>Experiments<a class="headerlink" href="#experiments" title="Link to this heading">#</a></h2>
<p>DeerLab supports a wide range of dipolar EPR experiments (4-pulse DEER, 4-pulse DEER, RIDME, etc). Experiments differ in the number and nature of their modulated dipolar pathways. Each of these pathways leads to a dipolar modulation contribution to the total dipolar signal, with specific amplitude and refocusing times. The overall dipolar signal is the sum of an unmodulated contribution and a contribution from all modulated pathways, each of which with its own amplitude, refocusing time, and harmonic. For each supported experiment, there is a dedicated experiment :ref:` constructor &lt;modelsref_ex&gt;` starting with <code class="docutils literal notranslate"><span class="pre">ex_</span></code>, which generate experimental information on the pathway refocusing times and amplitudes based on the type of experiment and the experimental pulse sequence delays. This information can later be used to refine and constrain the dipolar models.</p>
</section>
<section id="dipolar-kernels">
<h2>Dipolar kernels<a class="headerlink" href="#dipolar-kernels" title="Link to this heading">#</a></h2>
<p>One of the core functions of DeerLab’s dipolar EPR applications is <code class="docutils literal notranslate"><span class="pre">dipolarkernel</span></code>. It constructs the kernel that provides the connection between the distance distribution and the time-domain dipolar signal via</p>
<div class="math-wrapper docutils container">
<div class="math">
<p><img src="_images/math/d782fd11836a84cd933640472d4e60e61d91cf41.svg" alt="V(t) = \int K(t,r)P(r) \mathrm{d}r"/></p>
</div></div>
<p>The simplest dipolar kernel just requires the time-vector <code class="docutils literal notranslate"><span class="pre">t</span></code> and distance-vector <code class="docutils literal notranslate"><span class="pre">r</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>        <span class="c1"># time axis, in µs</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>        <span class="c1"># distance axis, in nm</span>
<span class="n">K0</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>      <span class="c1"># dipolar kernel matrix</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">K0</span></code> is the kernel matrix. It assumes no orientation selection and absence of exchange couplings. To calculate the dipolar signal corresponding to a distance distribution <code class="docutils literal notranslate"><span class="pre">P</span></code> according to the equation above, use</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">V</span> <span class="o">=</span> <span class="n">K0</span><span class="nd">@P</span>                        <span class="c1"># calculate signal from distribution</span>
</pre></div>
</div>
<p>The above <code class="docutils literal notranslate"><span class="pre">K0</span></code> is the most elementary kernel, giving a single dipolar evolution function centered at time zero, with modulation depth 1, and without any background decay. The kernel can also account for the background and the dipolar pathways. Then, operation  <code class="docutils literal notranslate"><span class="pre">V=K&#64;P</span></code> will return the complete time-domain dipolar signal. Here is an example for a 4-pulse DEER signal</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lam</span> <span class="o">=</span> <span class="mf">0.4</span>                               <span class="c1"># modulation depth</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">bg_hom3d</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="n">lam</span><span class="p">)</span>              <span class="c1"># background (inter-molecular modulation function)</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">mod</span><span class="o">=</span><span class="n">lam</span><span class="p">,</span><span class="n">bg</span><span class="o">=</span><span class="n">B</span><span class="p">)</span>  <span class="c1"># kernel matrix, including lam and B</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">K</span><span class="nd">@P</span>                                 <span class="c1"># calculate signal from distribution</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>                           <span class="c1"># plotting</span>
</pre></div>
</div>
<p>For experiments with more than one modulated dipolar pathway (such as 5-pulse DEER), modulation amplitudes and refocusing times for each pathway must be provided to <code class="docutils literal notranslate"><span class="pre">dipolarkernel</span></code>. Additionally, the background must be provided as a callable function that takes only time and modulation amplitude and encapsulates all other parameters. For example, for a 5-pulse DEER signal</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Lam0</span> <span class="o">=</span> <span class="mf">0.5</span>      <span class="c1"># amplitude of the unmodulated component</span>
<span class="n">lam1</span> <span class="o">=</span> <span class="mf">0.4</span>      <span class="c1"># amplitude of the primary modulated pathway</span>
<span class="n">lam2</span> <span class="o">=</span> <span class="mf">0.1</span>      <span class="c1"># amplitude of the secondary modulated pathway</span>
<span class="n">tref1</span> <span class="o">=</span> <span class="mf">0.0</span>     <span class="c1"># refocusing time of the primary pathway, in µs</span>
<span class="n">tref2</span> <span class="o">=</span> <span class="mf">3.1</span>     <span class="c1"># refocusing time of the secondary pathway, in µs</span>

<span class="c1"># Dipolar pathways of the 5-pulse DEER experiment</span>
<span class="n">pathways</span> <span class="o">=</span> <span class="p">[[</span><span class="n">Lam0</span><span class="p">],</span>
            <span class="p">[</span><span class="n">lam1</span><span class="p">,</span><span class="n">tref1</span><span class="p">],</span>
            <span class="p">[</span><span class="n">lam2</span><span class="p">,</span><span class="n">tref2</span><span class="p">]]</span>
<span class="n">Bfcn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">,</span><span class="n">lam</span><span class="p">:</span> <span class="n">dl</span><span class="o">.</span><span class="n">bg_hom3d</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="n">lam</span><span class="p">)</span>             <span class="c1"># Function for background</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">pathways</span><span class="o">=</span><span class="n">pathways</span><span class="p">,</span><span class="n">bg</span><span class="o">=</span><span class="n">Bfcn</span><span class="p">)</span>     <span class="c1"># 5-pulse DEER dipolar kernel</span>
</pre></div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">dipolarkernel</span></code> also has <a class="reference internal" href="_autosummary/deerlab.dipolarkernel.html#dipolarkernel"><span class="std std-ref">options</span></a> to set the excitation bandwidth, to select the internal calculation method, and more.</p>
</section>
<section id="dipolar-signals">
<h2>Dipolar signals<a class="headerlink" href="#dipolar-signals" title="Link to this heading">#</a></h2>
<p>Dipolar signals are the results of the many different dipolar EPR spectroscopy experiments. They represent the data from which distance distributions can be infered.  DeerLab provides the tools for simulating dipolar signals originating from different experiments.</p>
<p>To generate complete time-domain signals from a distance distribution and a background decay, use the function <code class="docutils literal notranslate"><span class="pre">dipolarkernel</span></code> (described above) and apply it to the distance distribution:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">mod</span><span class="o">=</span><span class="n">lam</span><span class="p">,</span><span class="n">bg</span><span class="o">=</span><span class="n">B</span><span class="p">)</span>   <span class="c1"># generate dipolar kernel</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">K</span><span class="nd">@P</span>                                  <span class="c1"># generate dipolar signal</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>
</pre></div>
</div>
<p>It is possible to add noise to simulated data by using the <code class="docutils literal notranslate"><span class="pre">whitegaussnoise</span></code> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.05</span>                           <span class="c1"># noise level</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">K</span><span class="nd">@P</span> <span class="o">+</span> <span class="n">dl</span><span class="o">.</span><span class="n">whitegaussnoise</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">sigma</span><span class="p">)</span>  <span class="c1"># add some noise</span>
</pre></div>
</div>
<p>With this, uncorrelated Gaussian noise with standard deviation <code class="docutils literal notranslate"><span class="pre">sigma</span></code> is added to the noise-free signal.</p>
<p>Adding a phase rotation is also possible, yielding a complex-valued signal with non-zero imaginary component. The phase shift on the noise has to be taken into account too:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>                      <span class="c1"># phase shift, radians</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">K</span><span class="nd">@P</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">phase</span><span class="p">)</span>               <span class="c1"># add a phase shift</span>
<span class="n">rnoise</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">whitegaussnoise</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">sigma</span><span class="p">)</span> <span class="c1"># noise of real component noise</span>
<span class="n">inoise</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">whitegaussnoise</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">sigma</span><span class="p">)</span> <span class="c1"># noise of imaginary component</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">V</span> <span class="o">+</span> <span class="n">rnoise</span> <span class="o">+</span> <span class="n">inoise</span>              <span class="c1"># complex-valued noisy signal</span>
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="getting_started.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Getting Started</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="user_guide.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">User Guide</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2019-2023, Luis Fábregas-Ibáñez, Stefan Stoll, Hugo Karas and others
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Basics</a><ul>
<li><a class="reference internal" href="#distance-distributions">Distance distributions</a></li>
<li><a class="reference internal" href="#dipolar-background">Dipolar background</a></li>
<li><a class="reference internal" href="#experiments">Experiments</a></li>
<li><a class="reference internal" href="#dipolar-kernels">Dipolar kernels</a></li>
<li><a class="reference internal" href="#dipolar-signals">Dipolar signals</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=7f41d439"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=4ea706d9"></script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    </body>
</html>