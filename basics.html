
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Basics &#8212; DeerLab</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="_static/theme_override.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Getting Started" href="getting_started.html" />
    <link rel="prev" title="User Guide" href="user_guide.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="index.html">
  <img src="_static/logo_docs_paths.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <div class="container-fluid  px-0">

    <div class="sk-navbar-collapse collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
          <a class="sk-nav-link nav-link" href="installation.html">Installation</a>
        </li>

        <li class="dropdown">
          <a class="dropbtn" href="user_guide.html" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">User Guide</a>
          <div class="dropdown-content" aria-labelledby="navbarDropdown">
              <a class="sk-nav-dropdown-item dropdown-item" href="#">Basics</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="getting_started.html">Getting Started</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="dipolar_guide_modelling.html">Modelling</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="dipolar_guide_fitting.html">Fitting</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="theory.html">Theory</a>
          </div>
        </li>

        <li class="dropdown">
            <a class="dropbtn" href="advanced_guide.html" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Advanced Guides</a>
            <div class="dropdown-content" aria-labelledby="navbarDropdown">
                <a class="sk-nav-dropdown-item dropdown-item" href="modelling_guide.html">Modelling Guide</a>
                <a class="sk-nav-dropdown-item dropdown-item" href="fitting_guide.html">Fitting Guide</a>
                <a class="sk-nav-dropdown-item dropdown-item" href="uncertainty_guide.html">Uncertainty Guide</a>
            </div>
          </li>

        <li class="nav-item">
          <a class="sk-nav-link nav-link" href="examples.html">Examples</a>
        </li>

        <li class="nav-item">
          <a class="sk-nav-link nav-link" href="modelsref.html">Models</a>
        </li>

        
        <li class="nav-item">
            <a class="sk-nav-link nav-link" href="reference.html">Reference</a>
          </li>

        <li class="dropdown">
          <a class="dropbtn" href="more.html" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">More</a>
          <div class="dropdown-content" aria-labelledby="navbarDropdown">
              <a class="sk-nav-dropdown-item dropdown-item" href="changelog.html">Release Notes</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="contributing.html">Contributing</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="support.html">Support</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="license.html">License</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="https://github.com/JeschkeLab/DeerLab">GitHub</a>
              <a class="sk-nav-dropdown-item dropdown-item" href="https://pypi.org/project/DeerLab/#history">Other Versions and Download</a>
          </div>
        </li>
      </ul>

    </div>
  </div>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="getting_started.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dipolar_guide_modelling.html">
   Modelling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dipolar_guide_fitting.html">
   Fitting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="theory.html">
   Theory
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#distance-distributions">
   Distance distributions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dipolar-background">
   Dipolar background
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#experiments">
   Experiments
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dipolar-kernels">
   Dipolar kernels
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dipolar-signals">
   Dipolar signals
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="basics">
<h1>Basics<a class="headerlink" href="#basics" title="Permalink to this headline">#</a></h1>
<p>DeerLab applications to dipolar EPR spectroscopy relies on a few central quantities. They include distance distributions and model functions, background and their model functions, time-domain signals, and kernels. They are described in this section.</p>
<p>All functions in DeerLab use the same units: all distances are in units of <strong>nanometers</strong>, and all times in units of <strong>microseconds</strong>.</p>
<section id="distance-distributions">
<h2>Distance distributions<a class="headerlink" href="#distance-distributions" title="Permalink to this headline">#</a></h2>
<p>A distance distribution <img class="math" src="_images/math/865be106fc6ff8e698763f3b1bfb8777c311e175.svg" alt="P(r)"/> between two spins is represented by a pair of vectors: a distance vector <code class="docutils literal notranslate"><span class="pre">r</span></code> (in nanometers) and a vector of densities <code class="docutils literal notranslate"><span class="pre">P</span></code> (in inverse nanometers). The distance vector <code class="docutils literal notranslate"><span class="pre">r</span></code> can have linearly or non-linearly increasing values, but must have positive non-zero values. The elements <code class="docutils literal notranslate"><span class="pre">P[i]</span></code> are the distance distribution values at <code class="docutils literal notranslate"><span class="pre">r[i]</span></code> and are posiive or zero. Outside of the range defined by <code class="docutils literal notranslate"><span class="pre">r</span></code>, the distribution <code class="docutils literal notranslate"><span class="pre">P</span></code> is assumed to be zero, i.e. the distribution is truncated to the range <code class="docutils literal notranslate"><span class="pre">r</span></code>. The distance distribution <code class="docutils literal notranslate"><span class="pre">P</span></code> is normalized such that the integral over the range of the provided <code class="docutils literal notranslate"><span class="pre">r</span></code> equals one:</p>
<div class="math">
<p><img src="_images/math/40d7709134fc915404f6e8db4c8228b788d0c999.svg" alt="\int_{r_\mathrm{min}}^{r_\mathrm{max}} P(r) \mathrm{d}r = 1"/></p>
</div><p>DeerLab distinguishes between <em>non-parametric</em> and <em>parametric</em> distance distributions.</p>
<dl>
<dt>Non-parametric distance distributions</dt><dd><p>These provide the more general definition of distance distributions. They have no particular shape and are represented by the vectors <code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">r</span></code>.
For example, you can generate <code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">r</span></code> by an external program for spin label rotamer modeling or from molecular dynamics simulations.</p>
</dd>
<dt>Parametric distance distributions</dt><dd><p>These have specific shapes that are determined by a few parameters. DeerLab provides many parametric distance distribution <a class="reference internal" href="modelsref.html#modelsref-dd"><span class="std std-ref">built-in models</span></a>. All these model’s names start with the prefix <code class="docutils literal notranslate"><span class="pre">dd_</span></code> (<code class="docutils literal notranslate"><span class="pre">dd</span></code> stands for “distance distribution”). They take a distance vector <code class="docutils literal notranslate"><span class="pre">r</span></code> and a parameter vector <code class="docutils literal notranslate"><span class="pre">param</span></code> as inputs and return the distance distribution as a vector <code class="docutils literal notranslate"><span class="pre">P</span></code>. Here is an example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>        <span class="c1"># distance vector, in nm</span>
<span class="n">rmean</span> <span class="o">=</span> <span class="mi">3</span>                         <span class="c1"># nm, mean of Gaussian</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.2</span>                       <span class="c1"># nm, standard deviation of Gaussian</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">dd_gauss</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">rmean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="c1"># Gaussian distribution</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
</pre></div>
</div>
<p>To programmatically get information on a particular distance distribution <a class="reference internal" href="modelsref.html#modelsref-dd"><span class="std std-ref">model</span></a> and its parameters, print the model, which will return information on the model itself, its call signature, and a parameter table containing all the model parameters, its boundaries, start values and other useful information</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;print(dl.dd_gauss)</span>
<span class="go">Description: Gaussian distribution model</span>
<span class="go">Signature: (r, mean, std)</span>
<span class="go">Constants: [r]</span>
<span class="go">Parameter Table:</span>
<span class="go">======= ======= ======= ======== ======== ======= ====================</span>
<span class="go">Name    Lower   Upper    Type    Frozen   Units   Description</span>
<span class="go">======= ======= ======= ======== ======== ======= ====================</span>
<span class="go">mean        1      20   nonlin     No      nm     Mean</span>
<span class="go">std      0.05     2.5   nonlin     No      nm     Standard deviation</span>
<span class="go">======= ======= ======= ======== ======== ======= ====================</span>
</pre></div>
</div>
</dd>
</dl>
<p>In least-squares fitting, non-parametric distance distributions make fewer assumptions about the distribution than parametric distance distributions. They are more flexible and introduce less bias.</p>
</section>
<section id="dipolar-background">
<span id="bgmodels"></span><h2>Dipolar background<a class="headerlink" href="#dipolar-background" title="Permalink to this headline">#</a></h2>
<p>In DeerLab, all inter-molecular contributions to the dipolar modulation (i.e. the echo modulation function due to randomly distributed spins in the sample that are not part of the spin-labeled protein or object) are referred to as the dipolar background. DeerLab has a range of parametric models for the background. All these background <a class="reference internal" href="modelsref.html#modelsref-bg"><span class="std std-ref">model’s</span></a> names start with the prefix <code class="docutils literal notranslate"><span class="pre">bg_</span></code>. They take the time axis vector <code class="docutils literal notranslate"><span class="pre">t</span></code> (in microseconds) and a parameter vector <code class="docutils literal notranslate"><span class="pre">param</span></code> as inputs. The output is a background vector <code class="docutils literal notranslate"><span class="pre">B</span></code> defined over <code class="docutils literal notranslate"><span class="pre">t</span></code>. To get information on the model and its parameters, print the model</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;print(dl.bg_hom3d)</span>
<span class="go">Description: Background from homogeneous distribution of spins in a 3D medium</span>
<span class="go">Signature: (t, conc, lam)</span>
<span class="go">Constants: [t]</span>
<span class="go">Parameter Table:</span>
<span class="go">====== ======= ======= ======== ======== ======= ====================</span>
<span class="go"> Name   Lower   Upper    Type    Frozen   Units   Description</span>
<span class="go">====== ======= ======= ======== ======== ======= ====================</span>
<span class="go"> conc    0.01   5e+03   nonlin     No      μM     Spin concentration</span>
<span class="go"> lam        0       1   nonlin     No             Pathway amplitude</span>
<span class="go">====== ======= ======= ======== ======== ======= ====================</span>
</pre></div>
</div>
<p>DeerLab’s <a class="reference internal" href="modelsref.html#modelsref-bg"><span class="std std-ref">background models</span></a> fall into two categories, physical and phenomenological:</p>
<dl>
<dt>Physical background models</dt><dd><p>Describe particular distributions of spin labels in space and depend on physical parameters such as spin concentration, exclusion distances, and fractal dimensionality. The most common background model is <a class="reference internal" href="_autosummary/deerlab.bg_hom3d.html#bg-hom3d"><span class="std std-ref">deerlab.bg_hom3d</span></a>, which describes the signal due to a homogeneous three-dimensional distribution of spins of a given concentration. A background due to a homogeneous distribution of spins in fractal dimensions is available with <a class="reference internal" href="_autosummary/deerlab.bg_homfractal.html#bg-homfractal"><span class="std std-ref">deerlab.bg_homfractal</span></a>, and excluded-volume effects can be accounted for using <a class="reference internal" href="_autosummary/deerlab.bg_hom3dex.html#bg-hom3dex"><span class="std std-ref">deerlab.bg_hom3dex</span></a> to model the background.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>    <span class="c1"># time, in microseconds</span>
<span class="n">lam</span> <span class="o">=</span> <span class="mf">0.4</span>                      <span class="c1"># modulation depth</span>
<span class="n">conc</span> <span class="o">=</span> <span class="mi">70</span>                      <span class="c1"># spin concentration, in µM</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">bg_hom3d</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">conc</span><span class="p">,</span><span class="n">lam</span><span class="p">)</span>    <span class="c1"># homogeneous 3D background</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Phenomenological background models</dt><dd><p>Represent various mathematical functions that are intended to <em>mimic</em> the background decay, without reference to a particular spatial distribution of spins. The parameters of these models do no have a direct physical meaning. Some examples include <a class="reference internal" href="_autosummary/deerlab.bg_exp.html#bg-exp"><span class="std std-ref">deerlab.bg_exp</span></a>, which models the background decay as a simple exponential function, or <a class="reference internal" href="_autosummary/deerlab.bg_strexp.html#bg-strexp"><span class="std std-ref">deerlab.bg_strexp</span></a> which model the background decay as a stretched exponential function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>    <span class="c1"># time, in microseconds</span>
<span class="n">kappa</span> <span class="o">=</span> <span class="mf">0.35</span>                   <span class="c1"># decay rate, in inverse microseconds</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">bg_exp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">kappa</span><span class="p">)</span>         <span class="c1"># exponential background</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p>In general, it is preferable to use physical instead of phenomenological models.</p>
</section>
<section id="experiments">
<span id="exmodels"></span><h2>Experiments<a class="headerlink" href="#experiments" title="Permalink to this headline">#</a></h2>
<p>DeerLab supports a wide range of dipolar EPR experiments (4-pulse DEER, 4-pulse DEER, RIDME, etc). Experiments differ in the number and nature of their modulated dipolar pathways. Each of these pathways leads to a dipolar modulation contribution to the total dipolar signal, with specific amplitude and refocusing times. The overall dipolar signal is the sum of an unmodulated contribution and a contribution from all modulated pathways, each of which with its own amplitude, refocusing time, and harmonic. For each supported experiment, there is a dedicated experiment :ref:` constructor &lt;modelsref_ex&gt;` starting with <code class="docutils literal notranslate"><span class="pre">ex_</span></code>, which generate experimental information on the pathway refocusing times and amplitudes based on the type of experiment and the experimental pulse sequence delays. This information can later be used to refine and constrain the dipolar models.</p>
</section>
<section id="dipolar-kernels">
<h2>Dipolar kernels<a class="headerlink" href="#dipolar-kernels" title="Permalink to this headline">#</a></h2>
<p>One of the core functions of DeerLab’s dipolar EPR applications is <code class="docutils literal notranslate"><span class="pre">dipolarkernel</span></code>. It constructs the kernel that provides the connection between the distance distribution and the time-domain dipolar signal via</p>
<div class="math">
<p><img src="_images/math/d782fd11836a84cd933640472d4e60e61d91cf41.svg" alt="V(t) = \int K(t,r)P(r) \mathrm{d}r"/></p>
</div><p>The simplest dipolar kernel just requires the time-vector <code class="docutils literal notranslate"><span class="pre">t</span></code> and distance-vector <code class="docutils literal notranslate"><span class="pre">r</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>        <span class="c1"># time axis, in µs</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>        <span class="c1"># distance axis, in nm</span>
<span class="n">K0</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>      <span class="c1"># dipolar kernel matrix</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">K0</span></code> is the kernel matrix. It assumes no orientation selection and absence of exchange couplings. To calculate the dipolar signal corresponding to a distance distribution <code class="docutils literal notranslate"><span class="pre">P</span></code> according to the equation above, use</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">V</span> <span class="o">=</span> <span class="n">K0</span><span class="nd">@P</span>                        <span class="c1"># calculate signal from distribution</span>
</pre></div>
</div>
<p>The above <code class="docutils literal notranslate"><span class="pre">K0</span></code> is the most elementary kernel, giving a single dipolar evolution function centered at time zero, with modulation depth 1, and without any background decay. The kernel can also account for the background and the dipolar pathways. Then, operation  <code class="docutils literal notranslate"><span class="pre">V=K&#64;P</span></code> will return the complete time-domain dipolar signal. Here is an example for a 4-pulse DEER signal</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lam</span> <span class="o">=</span> <span class="mf">0.4</span>                               <span class="c1"># modulation depth</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">bg_hom3d</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="n">lam</span><span class="p">)</span>              <span class="c1"># background (inter-molecular modulation function)</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">mod</span><span class="o">=</span><span class="n">lam</span><span class="p">,</span><span class="n">bg</span><span class="o">=</span><span class="n">B</span><span class="p">)</span>  <span class="c1"># kernel matrix, including lam and B</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">K</span><span class="nd">@P</span>                                 <span class="c1"># calculate signal from distribution</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>                           <span class="c1"># plotting</span>
</pre></div>
</div>
<p>For experiments with more than one modulated dipolar pathway (such as 5-pulse DEER), modulation amplitudes and refocusing times for each pathway must be provided to <code class="docutils literal notranslate"><span class="pre">dipolarkernel</span></code>. Additionally, the background must be provided as a callable function that takes only time and modulation amplitude and encapsulates all other parameters. For example, for a 5-pulse DEER signal</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Lam0</span> <span class="o">=</span> <span class="mf">0.5</span>      <span class="c1"># amplitude of the unmodulated component</span>
<span class="n">lam1</span> <span class="o">=</span> <span class="mf">0.4</span>      <span class="c1"># amplitude of the primary modulated pathway</span>
<span class="n">lam2</span> <span class="o">=</span> <span class="mf">0.1</span>      <span class="c1"># amplitude of the secondary modulated pathway</span>
<span class="n">tref1</span> <span class="o">=</span> <span class="mf">0.0</span>     <span class="c1"># refocusing time of the primary pathway, in µs</span>
<span class="n">tref2</span> <span class="o">=</span> <span class="mf">3.1</span>     <span class="c1"># refocusing time of the secondary pathway, in µs</span>

<span class="c1"># Dipolar pathways of the 5-pulse DEER experiment</span>
<span class="n">pathways</span> <span class="o">=</span> <span class="p">[[</span><span class="n">Lam0</span><span class="p">],</span>
            <span class="p">[</span><span class="n">lam1</span><span class="p">,</span><span class="n">tref1</span><span class="p">],</span>
            <span class="p">[</span><span class="n">lam2</span><span class="p">,</span><span class="n">tref2</span><span class="p">]]</span>
<span class="n">Bfcn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">,</span><span class="n">lam</span><span class="p">:</span> <span class="n">dl</span><span class="o">.</span><span class="n">bg_hom3d</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="n">lam</span><span class="p">)</span>             <span class="c1"># Function for background</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">pathways</span><span class="o">=</span><span class="n">pathways</span><span class="p">,</span><span class="n">bg</span><span class="o">=</span><span class="n">Bfcn</span><span class="p">)</span>     <span class="c1"># 5-pulse DEER dipolar kernel</span>
</pre></div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">dipolarkernel</span></code> also has <a class="reference internal" href="_autosummary/deerlab.dipolarkernel.html#dipolarkernel"><span class="std std-ref">options</span></a> to set the excitation bandwidth, to select the internal calculation method, and more.</p>
</section>
<section id="dipolar-signals">
<h2>Dipolar signals<a class="headerlink" href="#dipolar-signals" title="Permalink to this headline">#</a></h2>
<p>Dipolar signals are the results of the many different dipolar EPR spectroscopy experiments. They represent the data from which distance distributions can be infered.  DeerLab provides the tools for simulating dipolar signals originating from different experiments.</p>
<p>To generate complete time-domain signals from a distance distribution and a background decay, use the function <code class="docutils literal notranslate"><span class="pre">dipolarkernel</span></code> (described above) and apply it to the distance distribution:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">mod</span><span class="o">=</span><span class="n">lam</span><span class="p">,</span><span class="n">bg</span><span class="o">=</span><span class="n">B</span><span class="p">)</span>   <span class="c1"># generate dipolar kernel</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">K</span><span class="nd">@P</span>                                  <span class="c1"># generate dipolar signal</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>
</pre></div>
</div>
<p>It is possible to add noise to simulated data by using the <code class="docutils literal notranslate"><span class="pre">whitegaussnoise</span></code> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.05</span>                           <span class="c1"># noise level</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">K</span><span class="nd">@P</span> <span class="o">+</span> <span class="n">dl</span><span class="o">.</span><span class="n">whitegaussnoise</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">sigma</span><span class="p">)</span>  <span class="c1"># add some noise</span>
</pre></div>
</div>
<p>With this, uncorrelated Gaussian noise with standard deviation <code class="docutils literal notranslate"><span class="pre">sigma</span></code> is added to the noise-free signal.</p>
<p>Adding a phase rotation is also possible, yielding a complex-valued signal with non-zero imaginary component. The phase shift on the noise has to be taken into account too:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>                      <span class="c1"># phase shift, radians</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">K</span><span class="nd">@P</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">phase</span><span class="p">)</span>               <span class="c1"># add a phase shift</span>
<span class="n">rnoise</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">whitegaussnoise</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">sigma</span><span class="p">)</span> <span class="c1"># noise of real component noise</span>
<span class="n">inoise</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">whitegaussnoise</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">sigma</span><span class="p">)</span> <span class="c1"># noise of imaginary component</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">V</span> <span class="o">+</span> <span class="n">rnoise</span> <span class="o">+</span> <span class="n">inoise</span>              <span class="c1"># complex-valued noisy signal</span>
</pre></div>
</div>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="user_guide.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">User Guide</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="getting_started.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Getting Started</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2019-2022, Luis Fábregas-Ibáñez, Stefan Stoll, and others.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>